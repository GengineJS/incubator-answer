"use strict";(globalThis.webpackChunkanswer_static=globalThis.webpackChunkanswer_static||[]).push([[2701,5981,7602],{75981:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var n=s(99205),a=s(51588),l=s(81801),d=s(47185),r=s(48058),i=s(68179);const o=({showActionPassword:e,showActionStatus:t,showActionRole:s,currentUser:o,refreshUsers:c,showDeleteModal:u,userData:h})=>{const{t:x}=(0,a.B)("translation",{keyPrefix:"admin.users"}),m=(0,d.dj)(),j=(0,d.Qt)({callback:c}),v=(0,d.Ye)({onConfirm:e=>new Promise(((t,s)=>{(0,r.ej)(e).then((()=>{m.onShow({msg:x("update_password",{keyPrefix:"toast"}),variant:"success"}),t(!0)})).catch((e=>{s(e)}))}))}),p=(0,d.vx)(),_=e=>{(0,r.e8)({user_id:h.user_id,status:e}).then((()=>{null===c||void 0===c||c()}))},w=e=>{const{user_id:t,role_id:s,username:n}=h;n!==o.username?("role"===e&&j.onShow({id:t,role_id:s}),"password"===e&&v.onShow(t),"activation"===e&&p.onShow(t),"deactivate"===e&&l.aF.confirm({title:x("deactivate_user.title"),content:x("deactivate_user.content"),cancelBtnVariant:"link",confirmBtnVariant:"danger",cancelText:x("cancel",{keyPrefix:"btns"}),confirmText:x("deactivate",{keyPrefix:"btns"}),onConfirm:()=>{_("inactive")}}),"suspend"===e&&l.aF.confirm({title:x("suspend_user.title"),content:x("suspend_user.content"),cancelBtnVariant:"link",cancelText:x("cancel",{keyPrefix:"btns"}),confirmBtnVariant:"danger",confirmText:x("suspend",{keyPrefix:"btns"}),onConfirm:()=>{_("suspended")}}),"active"!==e&&"unsuspend"!==e||_("normal"),"delete"===e&&u({show:!0,userId:h.user_id})):m.onShow({msg:x("forbidden_operate_self",{keyPrefix:"toast"}),variant:"warning"})};return(0,i.jsx)("td",{className:"text-end",children:(0,i.jsxs)(n.A,{children:[(0,i.jsx)(n.A.Toggle,{variant:"link",className:"no-toggle p-0",children:(0,i.jsx)(l.In,{name:"three-dots-vertical",title:x("action")})}),(0,i.jsxs)(n.A.Menu,{children:[e?(0,i.jsx)(n.A.Item,{onClick:()=>w("password"),children:x("set_new_password")}):null,s?(0,i.jsx)(n.A.Item,{onClick:()=>w("role"),children:x("change_role")}):null,"inactive"===h.status?(0,i.jsx)(n.A.Item,{onClick:()=>w("activation"),children:x("btn_name",{keyPrefix:"inactive"})}):null,t&&"deleted"!==h.status?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.A.Divider,{}),"inactive"===h.status&&(0,i.jsx)(n.A.Item,{onClick:()=>w("active"),children:x("active",{keyPrefix:"btns"})}),"normal"===h.status&&(0,i.jsx)(n.A.Item,{onClick:()=>w("deactivate"),children:x("deactivate",{keyPrefix:"btns"})}),"normal"===h.status&&(0,i.jsx)(n.A.Item,{onClick:()=>w("suspend"),children:x("suspend",{keyPrefix:"btns"})}),"suspended"===h.status&&(0,i.jsx)(n.A.Item,{onClick:()=>w("unsuspend"),children:x("unsuspend",{keyPrefix:"btns"})}),(0,i.jsx)(n.A.Item,{onClick:()=>w("delete"),children:x("delete",{keyPrefix:"btns"})})]}):null]})]})})}},67602:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var n=s(28915),a=s(97095),l=s(46261),d=s(53799),r=s(51588),i=s(68179);const o=({show:e,onClose:t,onDelete:s})=>{const{t:o}=(0,r.B)("translation",{keyPrefix:"admin.users"}),[c,u]=(0,n.useState)(!1),h=()=>{t(),u(!1)};return(0,i.jsxs)(a.A,{show:e,onHide:h,children:[(0,i.jsx)(a.A.Header,{closeButton:!0,children:(0,i.jsx)(a.A.Title,{children:o("delete_user.title")})}),(0,i.jsxs)(a.A.Body,{children:[(0,i.jsx)("p",{children:o("delete_user.content")}),(0,i.jsxs)("div",{className:"text-danger mb-2",children:[o("delete_user.remove")," ",o("optional",{keyPrefix:"form"})]}),(0,i.jsx)(l.A,{children:(0,i.jsx)(l.A.Group,{controlId:"delete_user",children:(0,i.jsxs)(l.A.Check,{type:"checkbox",id:"delete_user",children:[(0,i.jsx)(l.A.Check.Input,{type:"checkbox",checked:c,onChange:e=>{u(e.target.checked)}}),(0,i.jsxs)(l.A.Check.Label,{htmlFor:"delete_user",children:[(0,i.jsx)("span",{children:o("delete_user.label")}),(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"small text-secondary",children:o("delete_user.text")})]})]})})})]}),(0,i.jsxs)(a.A.Footer,{children:[(0,i.jsx)(d.A,{variant:"link",onClick:h,children:o("cancel",{keyPrefix:"btns"})}),(0,i.jsx)(d.A,{variant:"danger",onClick:()=>s(c),children:o("delete",{keyPrefix:"btns"})})]})]})}},2701:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var n=s(28915),a=s(10808),l=s(53799),d=s(46261),r=s(22807),i=s(65200),o=s(51588),c=s(14577),u=s.n(c),h=s(81801),x=s(47185),m=s(48058),j=s(24978),v=s(4440),p=s(67602),_=s(75981),w=s(68179);const f=["normal","staff","inactive","suspended","deleted"],b={normal:"text-bg-success",suspended:"text-bg-danger",deleted:"text-bg-danger",inactive:"text-bg-secondary"},k=()=>{const{t:e}=(0,o.B)("translation",{keyPrefix:"admin.users"}),[t,s]=(0,n.useState)({show:!1,userId:""}),[c,k]=(0,i.ok)(),g=c.get("filter")||f[0],y=Number(c.get("page")||"1"),A=c.get("query")||"",C=(0,j.bb)((e=>e.user)),{agent:P}=(0,j.ym)(),[N,S]=(0,n.useState)({allow_create_user:!0,allow_update_user_status:!0,allow_update_user_password:!0,allow_update_user_role:!0}),{data:I,isLoading:B,mutate:T}=(0,m.If)({page:y,page_size:10,query:A,..."all"===g?{}:"staff"===g?{staff:!0}:{status:g}}),z=(0,x.GW)({onConfirm:e=>new Promise(((t,s)=>{(0,m.g1)(e).then((()=>{/all|staff/.test(g)&&1===y&&T(),t(!0)})).catch((e=>{s(e)}))}))});(0,n.useEffect)((()=>{null!==P&&void 0!==P&&P.enabled&&(0,m.hx)().then((e=>{S(e)}))}),[P]);const D=e=>{s(e)},F=!(null!==P&&void 0!==P&&P.enabled)||(null===P||void 0===P?void 0:P.enabled)&&(null===N||void 0===N?void 0:N.allow_create_user),H=!(null!==P&&void 0!==P&&P.enabled)||(null===P||void 0===P?void 0:P.enabled)&&(null===N||void 0===N?void 0:N.allow_update_user_password),M=!(null!==P&&void 0!==P&&P.enabled)||(null===P||void 0===P?void 0:P.enabled)&&(null===N||void 0===N?void 0:N.allow_update_user_role),U=!(null!==P&&void 0!==P&&P.enabled)||(null===P||void 0===P?void 0:P.enabled)&&(null===N||void 0===N?void 0:N.allow_update_user_status),V=H||M||U;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("h3",{className:"mb-4",children:e("title")}),(0,w.jsxs)("div",{className:"d-flex flex-wrap justify-content-between align-items-center mb-3",children:[(0,w.jsxs)(a.A,{direction:"horizontal",gap:3,children:[(0,w.jsx)(h.gu,{data:f,currentSort:g,sortKey:"filter",i18nKeyPrefix:"admin.users"}),F?(0,w.jsx)(l.A,{variant:"outline-primary",size:"sm",onClick:()=>z.onShow(),children:e("add_user")}):null]}),(0,w.jsx)(d.A.Control,{size:"sm",type:"search",value:A,onChange:e=>{c.set("query",e.target.value),c.delete("page"),k(c)},placeholder:e("filter.placeholder"),style:{width:"12.25rem"},className:"mt-3 mt-sm-0"})]}),(0,w.jsxs)(r.A,{responsive:!0,children:[(0,w.jsx)("thead",{children:(0,w.jsxs)("tr",{children:[(0,w.jsx)("th",{children:e("name")}),(0,w.jsx)("th",{style:{width:"12%"},children:e("reputation")}),(0,w.jsx)("th",{style:{width:"20%"},className:"min-w-15",children:e("email")}),(0,w.jsx)("th",{className:"text-nowrap",style:{width:"15%"},children:e("created_at")}),("deleted"===g||"suspended"===g)&&(0,w.jsx)("th",{className:"text-nowrap",style:{width:"15%"},children:e("deleted"===g?"delete_at":"suspend_at")}),(0,w.jsx)("th",{style:{width:"12%"},children:e("status")}),"suspended"!==g&&"deleted"!==g&&(0,w.jsx)("th",{style:{width:"12%"},children:e("role")}),"deleted"!==g?(0,w.jsx)("th",{style:{width:"8%"},className:"text-end",children:e("action")}):null]})}),(0,w.jsx)("tbody",{className:"align-middle",children:null===I||void 0===I?void 0:I.list.map((t=>(0,w.jsxs)("tr",{children:[(0,w.jsx)("td",{children:(0,w.jsx)(h.fZ,{data:t,className:"fs-6",avatarSize:"32px",avatarSearchStr:"s=48",avatarClass:"me-2",showReputation:!1,nameMaxWidth:"160px"})}),(0,w.jsx)("td",{children:(0,v.B4)(t.rank)}),(0,w.jsx)("td",{className:"text-break",children:t.e_mail}),(0,w.jsx)("td",{children:(0,w.jsx)(h.H0,{time:t.created_at})}),"suspended"===g&&(0,w.jsx)("td",{className:"text-nowrap",children:(0,w.jsx)(h.H0,{time:t.suspended_at})}),"deleted"===g&&(0,w.jsx)("td",{className:"text-nowrap",children:(0,w.jsx)(h.H0,{time:t.deleted_at})}),(0,w.jsx)("td",{children:(0,w.jsx)("span",{className:u()("badge",b[t.status]),children:e(t.status)})}),"suspended"!==g&&"deleted"!==g&&(0,w.jsx)("td",{children:(0,w.jsx)("span",{className:"badge text-bg-light",children:e(t.role_name)})}),"deleted"===g||!V&&"inactive"!==t.status?null:(0,w.jsx)(_.default,{userData:t,showActionPassword:H,showActionRole:M,showActionStatus:U,currentUser:C,refreshUsers:T,showDeleteModal:D})]},t.user_id)))})]}),Number(null===I||void 0===I?void 0:I.count)<=0&&!B&&(0,w.jsx)(h.Sv,{}),(0,w.jsx)("div",{className:"mt-4 mb-2 d-flex justify-content-center",children:(0,w.jsx)(h.dK,{currentPage:y,totalSize:(null===I||void 0===I?void 0:I.count)||0,pageSize:10})}),(0,w.jsx)(p.default,{show:t.show,onClose:()=>{D({show:!1,userId:""})},onDelete:e=>(e=>{(0,m.e8)({user_id:t.userId,status:"deleted",remove_all_content:e}).then((()=>{D({show:!1,userId:""}),T()}))})(e)})]})}}}]);
//# sourceMappingURL=2701.c1543488.chunk.js.map