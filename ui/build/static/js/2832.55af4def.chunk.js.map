{"version":3,"file":"static/js/2832.55af4def.chunk.js","mappings":"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","sources":["pages/Users/ChangeEmail/components/sendEmail.tsx","pages/Users/ChangeEmail/index.tsx"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { FC, memo, useState } from 'react';\nimport { Form, Button } from 'react-bootstrap';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from 'react-router-dom';\n\nimport type { PasswordResetReq, FormDataType } from '@/common/interface';\nimport { loggedUserInfoStore } from '@/stores';\nimport { changeEmail } from '@/services';\nimport { handleFormError, scrollToElementTop } from '@/utils';\nimport { useCaptchaPlugin } from '@/utils/pluginKit';\n\nconst Index: FC = () => {\n  const { t } = useTranslation('translation', { keyPrefix: 'change_email' });\n  const [formData, setFormData] = useState<FormDataType>({\n    e_mail: {\n      value: '',\n      isInvalid: false,\n      errorMsg: '',\n    },\n  });\n\n  const navigate = useNavigate();\n  const { user: userInfo, update: updateUser } = loggedUserInfoStore();\n\n  const emailCaptcha = useCaptchaPlugin('email');\n\n  const handleChange = (params: FormDataType) => {\n    setFormData({ ...formData, ...params });\n  };\n\n  const checkValidated = (): boolean => {\n    let bol = true;\n\n    if (!formData.e_mail.value) {\n      bol = false;\n      formData.e_mail = {\n        value: '',\n        isInvalid: true,\n        errorMsg: t('email.msg.empty'),\n      };\n    }\n    setFormData({\n      ...formData,\n    });\n    return bol;\n  };\n\n  const sendEmail = (e?: any) => {\n    if (e) {\n      e.preventDefault();\n    }\n    const params: PasswordResetReq = {\n      e_mail: formData.e_mail.value,\n    };\n    const imgCode = emailCaptcha?.getCaptcha();\n    if (imgCode?.verify) {\n      params.captcha_code = imgCode.captcha_code;\n      params.captcha_id = imgCode.captcha_id;\n    }\n\n    changeEmail(params)\n      .then(async () => {\n        await emailCaptcha?.close();\n        userInfo.e_mail = formData.e_mail.value;\n        updateUser(userInfo);\n        navigate('/users/login', { replace: true });\n      })\n      .catch((err) => {\n        if (err.isError) {\n          emailCaptcha?.handleCaptchaError(err.list);\n          const data = handleFormError(err, formData);\n          setFormData({ ...data });\n          const ele = document.getElementById(err.list[0].error_field);\n          scrollToElementTop(ele);\n        }\n      });\n  };\n\n  const handleSubmit = async (event: any) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (!checkValidated()) {\n      return;\n    }\n    if (!emailCaptcha) {\n      sendEmail();\n      return;\n    }\n    emailCaptcha.check(() => {\n      sendEmail();\n    });\n  };\n\n  const goBack = () => {\n    navigate('/users/login?status=inactive', { replace: true });\n  };\n\n  return (\n    <Form noValidate onSubmit={handleSubmit} autoComplete=\"off\">\n      <Form.Group controlId=\"email\" className=\"mb-3\">\n        <Form.Label>{t('email.label')}</Form.Label>\n        <Form.Control\n          required\n          type=\"email\"\n          value={formData.e_mail.value}\n          isInvalid={formData.e_mail.isInvalid}\n          onChange={(e) => {\n            handleChange({\n              e_mail: {\n                value: e.target.value,\n                isInvalid: false,\n                errorMsg: '',\n              },\n            });\n          }}\n        />\n        <Form.Control.Feedback type=\"invalid\">\n          {formData.e_mail.errorMsg}\n        </Form.Control.Feedback>\n      </Form.Group>\n\n      <div className=\"d-grid mb-3\">\n        <Button variant=\"primary\" type=\"submit\">\n          {t('btn_update')}\n        </Button>\n        <Button variant=\"link\" className=\"mt-2 d-block\" onClick={goBack}>\n          {t('btn_cancel')}\n        </Button>\n      </div>\n    </Form>\n  );\n};\n\nexport default memo(Index);\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { FC, memo } from 'react';\nimport { Container, Col } from 'react-bootstrap';\nimport { useTranslation } from 'react-i18next';\n\nimport { usePageTags } from '@/hooks';\nimport { WelcomeTitle } from '@/components';\n\nimport SendEmail from './components/sendEmail';\n\nconst Index: FC = () => {\n  const { t } = useTranslation('translation', { keyPrefix: 'change_email' });\n  usePageTags({\n    title: t('change_email', { keyPrefix: 'page_title' }),\n  });\n  return (\n    <Container style={{ paddingTop: '4rem', paddingBottom: '6rem' }}>\n      <WelcomeTitle />\n      <Col className=\"mx-auto\" md={6} lg={4} xl={3}>\n        <SendEmail />\n      </Col>\n    </Container>\n  );\n};\n\nexport default memo(Index);\n"],"names":["Index","t","useTranslation","keyPrefix","formData","setFormData","useState","e_mail","value","isInvalid","errorMsg","navigate","useNavigate","user","userInfo","update","updateUser","loggedUserInfoStore","emailCaptcha","useCaptchaPlugin","sendEmail","e","preventDefault","params","imgCode","getCaptcha","verify","captcha_code","captcha_id","changeEmail","then","async","close","replace","catch","err","isError","handleCaptchaError","list","data","handleFormError","ele","document","getElementById","error_field","scrollToElementTop","_jsxs","Form","noValidate","onSubmit","event","stopPropagation","checkValidated","bol","check","autoComplete","children","Group","controlId","className","_jsx","Label","Control","required","type","onChange","target","Feedback","Button","variant","onClick","goBack","memo","usePageTags","title","Container","style","paddingTop","paddingBottom","WelcomeTitle","Col","md","lg","xl","SendEmail"],"sourceRoot":""}