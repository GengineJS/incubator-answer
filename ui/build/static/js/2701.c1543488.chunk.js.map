{"version":3,"file":"static/js/2701.c1543488.chunk.js","mappings":"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","sources":["pages/Admin/Users/components/Action/index.tsx","pages/Admin/Users/components/DeleteUserModal/index.tsx","pages/Admin/Users/index.tsx"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Dropdown } from 'react-bootstrap';\nimport { useTranslation } from 'react-i18next';\n\nimport { Modal, Icon } from '@/components';\nimport {\n  useChangeUserRoleModal,\n  useChangePasswordModal,\n  useActivationEmailModal,\n  useToast,\n} from '@/hooks';\nimport { updateUserPassword, changeUserStatus } from '@/services';\n\ninterface Props {\n  showActionPassword?: boolean;\n  showActionStatus?: boolean;\n  showActionRole?: boolean;\n  currentUser;\n  refreshUsers: () => void;\n  showDeleteModal: (val) => void;\n  userData;\n}\n\nconst UserOperation = ({\n  showActionPassword,\n  showActionStatus,\n  showActionRole,\n  currentUser,\n  refreshUsers,\n  showDeleteModal,\n  userData,\n}: Props) => {\n  const { t } = useTranslation('translation', { keyPrefix: 'admin.users' });\n  const Toast = useToast();\n\n  const changeUserRoleModal = useChangeUserRoleModal({\n    callback: refreshUsers,\n  });\n  const changePasswordModal = useChangePasswordModal({\n    onConfirm: (rd) => {\n      return new Promise((resolve, reject) => {\n        updateUserPassword(rd)\n          .then(() => {\n            Toast.onShow({\n              msg: t('update_password', { keyPrefix: 'toast' }),\n              variant: 'success',\n            });\n            resolve(true);\n          })\n          .catch((e) => {\n            reject(e);\n          });\n      });\n    },\n  });\n\n  const activationEmailModal = useActivationEmailModal();\n\n  const postUserStatus = (statusType) => {\n    changeUserStatus({\n      user_id: userData.user_id,\n      status: statusType,\n    }).then(() => {\n      refreshUsers?.();\n      // onClose();\n    });\n  };\n\n  const handleAction = (type) => {\n    const { user_id, role_id, username } = userData;\n    if (username === currentUser.username) {\n      Toast.onShow({\n        msg: t('forbidden_operate_self', { keyPrefix: 'toast' }),\n        variant: 'warning',\n      });\n      return;\n    }\n\n    if (type === 'role') {\n      changeUserRoleModal.onShow({\n        id: user_id,\n        role_id,\n      });\n    }\n\n    if (type === 'password') {\n      changePasswordModal.onShow(user_id);\n    }\n\n    if (type === 'activation') {\n      activationEmailModal.onShow(user_id);\n    }\n\n    if (type === 'deactivate') {\n      // cons\n      Modal.confirm({\n        title: t('deactivate_user.title'),\n        content: t('deactivate_user.content'),\n        cancelBtnVariant: 'link',\n        confirmBtnVariant: 'danger',\n        cancelText: t('cancel', { keyPrefix: 'btns' }),\n        confirmText: t('deactivate', { keyPrefix: 'btns' }),\n        onConfirm: () => {\n          // active -> inactive\n          postUserStatus('inactive');\n        },\n      });\n    }\n\n    if (type === 'suspend') {\n      // cons\n      Modal.confirm({\n        title: t('suspend_user.title'),\n        content: t('suspend_user.content'),\n        cancelBtnVariant: 'link',\n        cancelText: t('cancel', { keyPrefix: 'btns' }),\n        confirmBtnVariant: 'danger',\n        confirmText: t('suspend', { keyPrefix: 'btns' }),\n        onConfirm: () => {\n          // active -> suspended\n          postUserStatus('suspended');\n        },\n      });\n    }\n\n    if (type === 'active' || type === 'unsuspend') {\n      // to normal\n      postUserStatus('normal');\n    }\n\n    if (type === 'delete') {\n      showDeleteModal({\n        show: true,\n        userId: userData.user_id,\n      });\n    }\n  };\n\n  return (\n    <td className=\"text-end\">\n      <Dropdown>\n        <Dropdown.Toggle variant=\"link\" className=\"no-toggle p-0\">\n          <Icon name=\"three-dots-vertical\" title={t('action')} />\n        </Dropdown.Toggle>\n        <Dropdown.Menu>\n          {showActionPassword ? (\n            <Dropdown.Item onClick={() => handleAction('password')}>\n              {t('set_new_password')}\n            </Dropdown.Item>\n          ) : null}\n          {showActionRole ? (\n            <Dropdown.Item onClick={() => handleAction('role')}>\n              {t('change_role')}\n            </Dropdown.Item>\n          ) : null}\n          {userData.status === 'inactive' ? (\n            <Dropdown.Item onClick={() => handleAction('activation')}>\n              {t('btn_name', { keyPrefix: 'inactive' })}\n            </Dropdown.Item>\n          ) : null}\n          {showActionStatus && userData.status !== 'deleted' ? (\n            <>\n              <Dropdown.Divider />\n              {userData.status === 'inactive' && (\n                <Dropdown.Item onClick={() => handleAction('active')}>\n                  {t('active', { keyPrefix: 'btns' })}\n                </Dropdown.Item>\n              )}\n              {userData.status === 'normal' && (\n                <Dropdown.Item onClick={() => handleAction('deactivate')}>\n                  {t('deactivate', { keyPrefix: 'btns' })}\n                </Dropdown.Item>\n              )}\n              {userData.status === 'normal' && (\n                <Dropdown.Item onClick={() => handleAction('suspend')}>\n                  {t('suspend', { keyPrefix: 'btns' })}\n                </Dropdown.Item>\n              )}\n              {userData.status === 'suspended' && (\n                <Dropdown.Item onClick={() => handleAction('unsuspend')}>\n                  {t('unsuspend', { keyPrefix: 'btns' })}\n                </Dropdown.Item>\n              )}\n              <Dropdown.Item onClick={() => handleAction('delete')}>\n                {t('delete', { keyPrefix: 'btns' })}\n              </Dropdown.Item>\n            </>\n          ) : null}\n        </Dropdown.Menu>\n      </Dropdown>\n    </td>\n  );\n};\n\nexport default UserOperation;\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { useState } from 'react';\nimport { Modal, Button, Form } from 'react-bootstrap';\nimport { useTranslation } from 'react-i18next';\n\nconst DeleteUserModal = ({ show, onClose, onDelete }) => {\n  const { t } = useTranslation('translation', { keyPrefix: 'admin.users' });\n  const [checkVal, setCheckVal] = useState(false);\n\n  const handleClose = () => {\n    onClose();\n    setCheckVal(false);\n  };\n\n  return (\n    <Modal show={show} onHide={handleClose}>\n      <Modal.Header closeButton>\n        <Modal.Title>{t('delete_user.title')}</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <p>{t('delete_user.content')}</p>\n        <div className=\"text-danger mb-2\">\n          {t('delete_user.remove')} {t('optional', { keyPrefix: 'form' })}\n        </div>\n        <Form>\n          <Form.Group controlId=\"delete_user\">\n            <Form.Check type=\"checkbox\" id=\"delete_user\">\n              <Form.Check.Input\n                type=\"checkbox\"\n                checked={checkVal}\n                onChange={(e) => {\n                  setCheckVal(e.target.checked);\n                }}\n              />\n              <Form.Check.Label htmlFor=\"delete_user\">\n                <span>{t('delete_user.label')}</span>\n                <br />\n                <span className=\"small text-secondary\">\n                  {t('delete_user.text')}\n                </span>\n              </Form.Check.Label>\n            </Form.Check>\n          </Form.Group>\n        </Form>\n      </Modal.Body>\n      <Modal.Footer>\n        <Button variant=\"link\" onClick={handleClose}>\n          {t('cancel', { keyPrefix: 'btns' })}\n        </Button>\n        <Button variant=\"danger\" onClick={() => onDelete(checkVal)}>\n          {t('delete', { keyPrefix: 'btns' })}\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  );\n};\n\nexport default DeleteUserModal;\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { FC, useEffect, useState } from 'react';\nimport { Form, Table, Button, Stack } from 'react-bootstrap';\nimport { useSearchParams } from 'react-router-dom';\nimport { useTranslation } from 'react-i18next';\n\nimport classNames from 'classnames';\n\nimport {\n  Pagination,\n  FormatTime,\n  BaseUserCard,\n  Empty,\n  QueryGroup,\n} from '@/components';\nimport * as Type from '@/common/interface';\nimport { useUserModal } from '@/hooks';\nimport {\n  useQueryUsers,\n  addUsers,\n  getAdminUcAgent,\n  AdminUcAgent,\n  changeUserStatus,\n} from '@/services';\nimport { loggedUserInfoStore, userCenterStore } from '@/stores';\nimport { formatCount } from '@/utils';\n\nimport DeleteUserModal from './components/DeleteUserModal';\nimport Action from './components/Action';\n\nconst UserFilterKeys: Type.UserFilterBy[] = [\n  'normal',\n  'staff',\n  'inactive',\n  'suspended',\n  'deleted',\n];\n\nconst bgMap = {\n  normal: 'text-bg-success',\n  suspended: 'text-bg-danger',\n  deleted: 'text-bg-danger',\n  inactive: 'text-bg-secondary',\n};\n\nconst PAGE_SIZE = 10;\nconst Users: FC = () => {\n  const { t } = useTranslation('translation', { keyPrefix: 'admin.users' });\n  const [deleteUserModalState, setDeleteUserModalState] = useState({\n    show: false,\n    userId: '',\n  });\n  const [urlSearchParams, setUrlSearchParams] = useSearchParams();\n  const curFilter = urlSearchParams.get('filter') || UserFilterKeys[0];\n  const curPage = Number(urlSearchParams.get('page') || '1');\n  const curQuery = urlSearchParams.get('query') || '';\n  const currentUser = loggedUserInfoStore((state) => state.user);\n  const { agent: ucAgent } = userCenterStore();\n  const [adminUcAgent, setAdminUcAgent] = useState<AdminUcAgent>({\n    allow_create_user: true,\n    allow_update_user_status: true,\n    allow_update_user_password: true,\n    allow_update_user_role: true,\n  });\n\n  const {\n    data,\n    isLoading,\n    mutate: refreshUsers,\n  } = useQueryUsers({\n    page: curPage,\n    page_size: PAGE_SIZE,\n    query: curQuery,\n    ...(curFilter === 'all'\n      ? {}\n      : curFilter === 'staff'\n        ? { staff: true }\n        : { status: curFilter }),\n  });\n\n  const userModal = useUserModal({\n    onConfirm: (userModel) => {\n      return new Promise((resolve, reject) => {\n        addUsers(userModel)\n          .then(() => {\n            if (/all|staff/.test(curFilter) && curPage === 1) {\n              refreshUsers();\n            }\n            resolve(true);\n          })\n          .catch((e) => {\n            reject(e);\n          });\n      });\n    },\n  });\n\n  const handleFilter = (e) => {\n    urlSearchParams.set('query', e.target.value);\n    urlSearchParams.delete('page');\n    setUrlSearchParams(urlSearchParams);\n  };\n  useEffect(() => {\n    if (ucAgent?.enabled) {\n      getAdminUcAgent().then((resp) => {\n        setAdminUcAgent(resp);\n      });\n    }\n  }, [ucAgent]);\n\n  const changeDeleteUserModalState = (modalData: {\n    show: boolean;\n    userId: string;\n  }) => {\n    setDeleteUserModalState(modalData);\n  };\n\n  const handleDelete = (val) => {\n    changeUserStatus({\n      user_id: deleteUserModalState.userId,\n      status: 'deleted',\n      remove_all_content: val,\n    }).then(() => {\n      changeDeleteUserModalState({\n        show: false,\n        userId: '',\n      });\n      refreshUsers();\n    });\n  };\n\n  const showAddUser =\n    !ucAgent?.enabled || (ucAgent?.enabled && adminUcAgent?.allow_create_user);\n  const showActionPassword =\n    !ucAgent?.enabled ||\n    (ucAgent?.enabled && adminUcAgent?.allow_update_user_password);\n\n  const showActionRole =\n    !ucAgent?.enabled ||\n    (ucAgent?.enabled && adminUcAgent?.allow_update_user_role);\n\n  const showActionStatus =\n    !ucAgent?.enabled ||\n    (ucAgent?.enabled && adminUcAgent?.allow_update_user_status);\n  const showAction = showActionPassword || showActionRole || showActionStatus;\n\n  return (\n    <>\n      <h3 className=\"mb-4\">{t('title')}</h3>\n      <div className=\"d-flex flex-wrap justify-content-between align-items-center mb-3\">\n        <Stack direction=\"horizontal\" gap={3}>\n          <QueryGroup\n            data={UserFilterKeys}\n            currentSort={curFilter}\n            sortKey=\"filter\"\n            i18nKeyPrefix=\"admin.users\"\n          />\n          {showAddUser ? (\n            <Button\n              variant=\"outline-primary\"\n              size=\"sm\"\n              onClick={() => userModal.onShow()}>\n              {t('add_user')}\n            </Button>\n          ) : null}\n        </Stack>\n\n        <Form.Control\n          size=\"sm\"\n          type=\"search\"\n          value={curQuery}\n          onChange={handleFilter}\n          placeholder={t('filter.placeholder')}\n          style={{ width: '12.25rem' }}\n          className=\"mt-3 mt-sm-0\"\n        />\n      </div>\n      <Table responsive>\n        <thead>\n          <tr>\n            <th>{t('name')}</th>\n            <th style={{ width: '12%' }}>{t('reputation')}</th>\n            <th style={{ width: '20%' }} className=\"min-w-15\">\n              {t('email')}\n            </th>\n            <th className=\"text-nowrap\" style={{ width: '15%' }}>\n              {t('created_at')}\n            </th>\n            {(curFilter === 'deleted' || curFilter === 'suspended') && (\n              <th className=\"text-nowrap\" style={{ width: '15%' }}>\n                {curFilter === 'deleted' ? t('delete_at') : t('suspend_at')}\n              </th>\n            )}\n\n            <th style={{ width: '12%' }}>{t('status')}</th>\n            {curFilter !== 'suspended' && curFilter !== 'deleted' && (\n              <th style={{ width: '12%' }}>{t('role')}</th>\n            )}\n            {curFilter !== 'deleted' ? (\n              <th style={{ width: '8%' }} className=\"text-end\">\n                {t('action')}\n              </th>\n            ) : null}\n          </tr>\n        </thead>\n        <tbody className=\"align-middle\">\n          {data?.list.map((user) => {\n            return (\n              <tr key={user.user_id}>\n                <td>\n                  <BaseUserCard\n                    data={user}\n                    className=\"fs-6\"\n                    avatarSize=\"32px\"\n                    avatarSearchStr=\"s=48\"\n                    avatarClass=\"me-2\"\n                    showReputation={false}\n                    nameMaxWidth=\"160px\"\n                  />\n                </td>\n                <td>{formatCount(user.rank)}</td>\n                <td className=\"text-break\">{user.e_mail}</td>\n                <td>\n                  <FormatTime time={user.created_at} />\n                </td>\n                {curFilter === 'suspended' && (\n                  <td className=\"text-nowrap\">\n                    <FormatTime time={user.suspended_at} />\n                  </td>\n                )}\n                {curFilter === 'deleted' && (\n                  <td className=\"text-nowrap\">\n                    <FormatTime time={user.deleted_at} />\n                  </td>\n                )}\n                <td>\n                  <span className={classNames('badge', bgMap[user.status])}>\n                    {t(user.status)}\n                  </span>\n                </td>\n                {curFilter !== 'suspended' && curFilter !== 'deleted' && (\n                  <td>\n                    <span className=\"badge text-bg-light\">\n                      {t(user.role_name)}\n                    </span>\n                  </td>\n                )}\n                {curFilter !== 'deleted' &&\n                (showAction || user.status === 'inactive') ? (\n                  <Action\n                    userData={user}\n                    showActionPassword={showActionPassword}\n                    showActionRole={showActionRole}\n                    showActionStatus={showActionStatus}\n                    currentUser={currentUser}\n                    refreshUsers={refreshUsers}\n                    showDeleteModal={changeDeleteUserModalState}\n                  />\n                ) : null}\n              </tr>\n            );\n          })}\n        </tbody>\n      </Table>\n      {Number(data?.count) <= 0 && !isLoading && <Empty />}\n      <div className=\"mt-4 mb-2 d-flex justify-content-center\">\n        <Pagination\n          currentPage={curPage}\n          totalSize={data?.count || 0}\n          pageSize={PAGE_SIZE}\n        />\n      </div>\n\n      <DeleteUserModal\n        show={deleteUserModalState.show}\n        onClose={() => {\n          changeDeleteUserModalState({\n            show: false,\n            userId: '',\n          });\n        }}\n        onDelete={(val) => handleDelete(val)}\n      />\n    </>\n  );\n};\n\nexport default Users;\n"],"names":["UserOperation","showActionPassword","showActionStatus","showActionRole","currentUser","refreshUsers","showDeleteModal","userData","t","useTranslation","keyPrefix","Toast","useToast","changeUserRoleModal","useChangeUserRoleModal","callback","changePasswordModal","useChangePasswordModal","onConfirm","rd","Promise","resolve","reject","updateUserPassword","then","onShow","msg","variant","catch","e","activationEmailModal","useActivationEmailModal","postUserStatus","statusType","changeUserStatus","user_id","status","handleAction","type","role_id","username","id","Modal","confirm","title","content","cancelBtnVariant","confirmBtnVariant","cancelText","confirmText","show","userId","_jsx","className","children","_jsxs","Dropdown","Toggle","Icon","name","Menu","Item","onClick","_Fragment","Divider","DeleteUserModal","onClose","onDelete","checkVal","setCheckVal","useState","handleClose","onHide","Header","closeButton","Title","Body","Form","Group","controlId","Check","Input","checked","onChange","target","Label","htmlFor","Footer","Button","UserFilterKeys","bgMap","normal","suspended","deleted","inactive","Users","deleteUserModalState","setDeleteUserModalState","urlSearchParams","setUrlSearchParams","useSearchParams","curFilter","get","curPage","Number","curQuery","loggedUserInfoStore","state","user","agent","ucAgent","userCenterStore","adminUcAgent","setAdminUcAgent","allow_create_user","allow_update_user_status","allow_update_user_password","allow_update_user_role","data","isLoading","mutate","useQueryUsers","page","page_size","query","staff","userModal","useUserModal","userModel","addUsers","test","useEffect","enabled","getAdminUcAgent","resp","changeDeleteUserModalState","modalData","showAddUser","showAction","Stack","direction","gap","QueryGroup","currentSort","sortKey","i18nKeyPrefix","size","Control","value","set","delete","placeholder","style","width","Table","responsive","list","map","BaseUserCard","avatarSize","avatarSearchStr","avatarClass","showReputation","nameMaxWidth","formatCount","rank","e_mail","FormatTime","time","created_at","suspended_at","deleted_at","classNames","role_name","Action","count","Empty","Pagination","currentPage","totalSize","pageSize","val","remove_all_content","handleDelete"],"sourceRoot":""}