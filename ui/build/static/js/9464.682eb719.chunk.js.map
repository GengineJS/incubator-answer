{"version":3,"file":"static/js/9464.682eb719.chunk.js","mappings":"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","sources":["pages/Tags/Detail/index.tsx"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { FC, useEffect, useState } from 'react';\nimport { Row, Col, Button } from 'react-bootstrap';\nimport {\n  useParams,\n  Link,\n  useNavigate,\n  useSearchParams,\n} from 'react-router-dom';\nimport { useTranslation } from 'react-i18next';\n\nimport { usePageTags } from '@/hooks';\nimport * as Type from '@/common/interface';\nimport { FollowingTags, CustomSidebar, Icon } from '@/components';\nimport {\n  useTagInfo,\n  useFollow,\n  useQuerySynonymsTags,\n  useQuestionList,\n} from '@/services';\nimport QuestionList, {\n  QUESTION_ORDER_KEYS,\n  TYPE_ORDER_KEYS,\n} from '@/components/QuestionList';\nimport HotQuestions from '@/components/HotQuestions';\nimport { escapeRemove, guard, Storage, scrollToDocTop } from '@/utils';\nimport { pathFactory } from '@/router/pathFactory';\nimport { QUESTIONS_ORDER_STORAGE_KEY } from '@/common/constants';\n\nconst Index: FC = () => {\n  const { t } = useTranslation('translation', { keyPrefix: 'tags' });\n  const navigate = useNavigate();\n  const routeParams = useParams();\n  const curTagName = routeParams.tagName || '';\n  const [urlSearchParams] = useSearchParams();\n  const storageOrder = Storage.get(QUESTIONS_ORDER_STORAGE_KEY);\n  const curOrder =\n    urlSearchParams.get('order') || storageOrder || QUESTION_ORDER_KEYS[0];\n  if (curOrder !== storageOrder) {\n    Storage.set(QUESTIONS_ORDER_STORAGE_KEY, curOrder);\n  }\n  const curPage = Number(urlSearchParams.get('page')) || 1;\n  const curOrderType = urlSearchParams.get('order_type') || TYPE_ORDER_KEYS[0];\n  const reqParams: Type.QueryQuestionsReq = {\n    page_size: 20,\n    page: curPage,\n    order: curOrder as Type.QuestionOrderBy,\n    tag: routeParams.tagName,\n    order_type: curOrderType,\n  };\n  const [tagInfo, setTagInfo] = useState<any>({});\n  const [tagFollow, setTagFollow] = useState<Type.FollowParams>();\n  const { data: tagResp, isLoading } = useTagInfo({ name: curTagName });\n  const { data: listData, isLoading: listLoading } = useQuestionList(reqParams);\n  const { data: followResp } = useFollow(tagFollow);\n  const { data: synonymsRes } = useQuerySynonymsTags(\n    tagInfo?.tag_id,\n    tagInfo?.status,\n  );\n  const toggleFollow = () => {\n    if (!guard.tryNormalLogged(true)) {\n      return;\n    }\n    setTagFollow({\n      is_cancel: tagInfo.is_follower,\n      object_id: tagInfo.tag_id,\n    });\n  };\n\n  useEffect(() => {\n    if (!listLoading) {\n      scrollToDocTop();\n    }\n  }, [listLoading]);\n\n  useEffect(() => {\n    if (tagResp) {\n      const info = { ...tagResp };\n      if (info.main_tag_slug_name) {\n        navigate(pathFactory.tagLanding(info.main_tag_slug_name), {\n          replace: true,\n        });\n        return;\n      }\n      if (followResp) {\n        info.is_follower = followResp.is_followed;\n      }\n\n      if (info.excerpt) {\n        info.excerpt =\n          info.excerpt.length > 256\n            ? [...info.excerpt].slice(0, 256).join('')\n            : info.excerpt;\n      }\n\n      setTagInfo(info);\n    }\n  }, [tagResp, followResp]);\n  let pageTitle = '';\n  if (tagInfo?.display_name) {\n    pageTitle = `'${tagInfo.display_name}' ${t('questions', {\n      keyPrefix: 'page_title',\n    })}`;\n  }\n  const keywords: string[] = [];\n  if (tagInfo?.slug_name) {\n    keywords.push(tagInfo.slug_name);\n  }\n  synonymsRes?.synonyms.forEach((o) => {\n    keywords.push(o.slug_name);\n  });\n  usePageTags({\n    title: pageTitle,\n    description: tagInfo?.description,\n    keywords: keywords.join(','),\n  });\n  return (\n    <Row className=\"pt-4 mb-5\">\n      <Col className=\"page-main flex-auto\">\n        {isLoading ? (\n          <div className=\"tag-box mb-5 placeholder-glow\">\n            <div className=\"mb-3 h3 placeholder\" style={{ width: '120px' }} />\n            <p\n              className=\"placeholder w-100 d-block align-top\"\n              style={{ height: '24px' }}\n            />\n\n            <div\n              className=\"placeholder d-block align-top\"\n              style={{ height: '38px', width: '100px' }}\n            />\n          </div>\n        ) : (\n          <div className=\"tag-box mb-5\">\n            <h3 className=\"mb-3\">\n              <Link\n                to={pathFactory.tagLanding(tagInfo.slug_name)}\n                replace\n                className=\"link-dark\">\n                {tagInfo.display_name}\n              </Link>\n            </h3>\n\n            <p className=\"text-break\">\n              {escapeRemove(tagInfo.excerpt) || t('no_desc')}\n              <Link to={pathFactory.tagInfo(curTagName)} className=\"ms-1\">\n                [{t('more')}]\n              </Link>\n            </p>\n\n            <div className=\"box-ft\">\n              {tagInfo.is_follower ? (\n                <div>\n                  <Button variant=\"primary\" onClick={() => toggleFollow()}>\n                    {t('button_following')}\n                  </Button>\n                  <Link\n                    className=\"btn btn-outline-secondary ms-2\"\n                    to=\"/users/settings/notify\">\n                    <Icon name=\"bell-fill\" />\n                  </Link>\n                </div>\n              ) : (\n                <Button\n                  variant=\"outline-primary\"\n                  onClick={() => toggleFollow()}>\n                  {t('button_follow')}\n                </Button>\n              )}\n            </div>\n          </div>\n        )}\n        <QuestionList\n          source=\"tag\"\n          data={listData}\n          order={curOrder}\n          isLoading={listLoading}\n        />\n      </Col>\n      <Col className=\"page-right-side mt-4 mt-xl-0\">\n        <CustomSidebar />\n        <FollowingTags />\n        <HotQuestions />\n      </Col>\n    </Row>\n  );\n};\n\nexport default Index;\n"],"names":["Index","t","useTranslation","keyPrefix","navigate","useNavigate","routeParams","useParams","curTagName","tagName","urlSearchParams","useSearchParams","storageOrder","Storage","get","QUESTIONS_ORDER_STORAGE_KEY","curOrder","QUESTION_ORDER_KEYS","set","curPage","Number","curOrderType","TYPE_ORDER_KEYS","reqParams","page_size","page","order","tag","order_type","tagInfo","setTagInfo","useState","tagFollow","setTagFollow","data","tagResp","isLoading","useTagInfo","name","listData","listLoading","useQuestionList","followResp","useFollow","synonymsRes","useQuerySynonymsTags","tag_id","status","toggleFollow","guard","is_cancel","is_follower","object_id","useEffect","scrollToDocTop","info","main_tag_slug_name","pathFactory","tagLanding","replace","is_followed","excerpt","length","slice","join","pageTitle","display_name","keywords","slug_name","push","synonyms","forEach","o","usePageTags","title","description","_jsxs","Row","className","children","Col","_jsx","style","width","height","Link","to","escapeRemove","Button","variant","onClick","Icon","QuestionList","source","CustomSidebar","FollowingTags","HotQuestions"],"sourceRoot":""}