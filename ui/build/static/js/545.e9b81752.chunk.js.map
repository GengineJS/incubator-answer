{"version":3,"file":"static/js/545.e9b81752.chunk.js","mappings":"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","sources":["pages/Review/components/QueuedContent/index.tsx","pages/Review/utils/generateData.ts"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { FC, useEffect, useState, useRef } from 'react';\nimport { Card, Alert, Stack, Button } from 'react-bootstrap';\nimport { useTranslation } from 'react-i18next';\nimport { Link, useSearchParams } from 'react-router-dom';\n\nimport classNames from 'classnames';\n\nimport { getPendingReviewPostList, putPendingReviewAction } from '@/services';\nimport {\n  BaseUserCard,\n  Tag,\n  FormatTime,\n  Icon,\n  ImgViewer,\n  htmlRender,\n} from '@/components';\nimport { scrollToDocTop } from '@/utils';\nimport type * as Type from '@/common/interface';\nimport { ADMIN_LIST_STATUS } from '@/common/constants';\nimport generateData from '../../utils/generateData';\n\ninterface IProps {\n  refreshCount: () => void;\n}\n\nconst Index: FC<IProps> = ({ refreshCount }) => {\n  const [urlSearch, setUrlSearchParams] = useSearchParams();\n  const objectId = urlSearch.get('objectId') || '';\n  const { t } = useTranslation('translation', { keyPrefix: 'page_review' });\n  const ref = useRef<HTMLDivElement>(null);\n  const [noTasks, setNoTasks] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [page, setPage] = useState(1);\n  const [reviewResp, setReviewResp] = useState<Type.QuestionDetailRes>();\n  const flagItemData = reviewResp?.list[0] as Type.QueuedReviewItem;\n\n  // console.log('pendingResp', reviewResp);\n\n  const resolveNextOne = (resp, pageNumber) => {\n    const { count, list = [] } = resp;\n    // auto rollback\n    if (!list.length && count && page !== 1) {\n      pageNumber = 1;\n      setPage(pageNumber);\n      // eslint-disable-next-line @typescript-eslint/no-use-before-define\n      queryNextOne(pageNumber, '');\n      return;\n    }\n    if (pageNumber !== page) {\n      setPage(pageNumber);\n    }\n    setReviewResp(resp);\n    if (!list.length) {\n      setNoTasks(true);\n    }\n    setTimeout(() => {\n      scrollToDocTop();\n    }, 150);\n  };\n\n  const queryNextOne = (pageNumber, id) => {\n    getPendingReviewPostList(pageNumber, id).then((resp) => {\n      resolveNextOne(resp, pageNumber);\n    });\n  };\n\n  useEffect(() => {\n    if (!ref.current) {\n      return;\n    }\n\n    setTimeout(() => {\n      htmlRender(ref.current);\n    }, 70);\n  }, [ref.current]);\n\n  useEffect(() => {\n    queryNextOne(page, objectId);\n  }, []);\n\n  const handleAction = (type: 'approve' | 'reject') => {\n    if (!flagItemData) {\n      return;\n    }\n    setIsLoading(true);\n    putPendingReviewAction({\n      status: type,\n      review_id: flagItemData?.review_id,\n    })\n      .then(() => {\n        refreshCount();\n        queryNextOne(page, '');\n        if (objectId) {\n          urlSearch.delete('objectId');\n          setUrlSearchParams(urlSearch);\n        }\n      })\n      .finally(() => {\n        setIsLoading(false);\n      });\n  };\n\n  const handlingSkip = () => {\n    queryNextOne(page + 1, '');\n    if (objectId) {\n      urlSearch.delete('objectId');\n      setUrlSearchParams(urlSearch);\n    }\n  };\n\n  const { object_type, author_user_info, object_status, reason } =\n    flagItemData || {\n      object_type: '',\n      author_user_info: null,\n      reason: null,\n      object_status: 0,\n    };\n\n  const { itemLink, itemId, itemTimePrefix } = generateData(flagItemData);\n\n  if (noTasks) return null;\n  return (\n    <Card>\n      <Card.Header>\n        {object_type !== 'user' ? t('queued_post') : t('queued_post_user')}\n      </Card.Header>\n      <Card.Body className=\"p-0\">\n        <Alert variant=\"info\" className=\"border-0 rounded-0 mb-0\">\n          <Stack\n            direction=\"horizontal\"\n            gap={1}\n            className=\"align-items-center mb-2\">\n            <div className=\"small d-flex align-items-center\">\n              <Icon type=\"bi\" name=\"plugin\" size=\"24px\" className=\"me-2 lh-1\" />\n              <span>{flagItemData?.submitter_display_name}</span>\n            </div>\n            {flagItemData?.submit_at && (\n              <FormatTime\n                time={flagItemData.submit_at}\n                className=\"small text-secondary\"\n                preFix={t('proposed')}\n              />\n            )}\n          </Stack>\n          <Stack className=\"align-items-start\">\n            <p className=\"mb-0\">{reason}</p>\n          </Stack>\n        </Alert>\n        <div className=\"p-3\">\n          <small className=\"d-block text-secondary mb-4\">\n            <span>{t(object_type, { keyPrefix: 'btns' })} </span>\n            <Link to={itemLink} target=\"_blank\" className=\"link-secondary\">\n              #{itemId}\n            </Link>\n          </small>\n          {object_type === 'question' && (\n            <>\n              <h5 className=\"mb-3\">{flagItemData?.title}</h5>\n              <div className=\"mb-4\">\n                {flagItemData?.tags?.map((item) => {\n                  return (\n                    <Tag key={item.slug_name} className=\"me-1\" data={item} />\n                  );\n                })}\n              </div>\n            </>\n          )}\n          <div className=\"small font-monospace\">\n            <ImgViewer>\n              <article\n                ref={ref}\n                className=\"fmt text-break text-wrap\"\n                dangerouslySetInnerHTML={{ __html: flagItemData?.parsed_text }}\n              />\n            </ImgViewer>\n          </div>\n          <div className=\"d-flex flex-wrap align-items-center justify-content-between mt-4\">\n            <div>\n              <span\n                className={classNames(\n                  'badge',\n                  ADMIN_LIST_STATUS[object_status]?.variant,\n                )}>\n                {t(ADMIN_LIST_STATUS[object_status]?.name, {\n                  keyPrefix: 'btns',\n                })}\n              </span>\n              {flagItemData?.object_show_status === 2 && (\n                <span\n                  className={classNames(\n                    'ms-1 badge',\n                    ADMIN_LIST_STATUS.unlisted.variant,\n                  )}>\n                  {t(ADMIN_LIST_STATUS.unlisted.name, { keyPrefix: 'btns' })}\n                </span>\n              )}\n            </div>\n            <div className=\"d-flex align-items-center small\">\n              <BaseUserCard\n                data={author_user_info}\n                avatarSize=\"24\"\n                avatarClass=\"me-2\"\n              />\n              <FormatTime\n                time={Number(flagItemData?.created_at)}\n                className=\"text-secondary ms-1 flex-shrink-0\"\n                preFix={t(itemTimePrefix, { keyPrefix: 'question_detail' })}\n              />\n            </div>\n          </div>\n        </div>\n      </Card.Body>\n\n      <Card.Footer className=\"p-3\">\n        <p>\n          {object_type !== 'user'\n            ? t('approve_post_tip')\n            : t('approve_user_tip')}\n        </p>\n        <Stack direction=\"horizontal\" gap={2}>\n          <Button\n            variant=\"outline-primary\"\n            disabled={isLoading}\n            onClick={() => handleAction('approve')}>\n            {t('approve', { keyPrefix: 'btns' })}\n          </Button>\n          <Button\n            variant=\"outline-primary\"\n            disabled={isLoading}\n            onClick={() => handleAction('reject')}>\n            {t('reject', { keyPrefix: 'btns' })}\n          </Button>\n\n          <Button\n            variant=\"outline-primary\"\n            disabled={isLoading}\n            onClick={handlingSkip}>\n            {t('skip', { keyPrefix: 'btns' })}\n          </Button>\n        </Stack>\n      </Card.Footer>\n    </Card>\n  );\n};\n\nexport default Index;\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { pathFactory } from '@/router/pathFactory';\n\nexport default (data: any) => {\n  if (!data?.object_id) {\n    return {\n      itemLink: '',\n      itemId: '',\n      itemTimePrefix: '',\n    };\n  }\n\n  const {\n    object_type = '',\n    object_id = '',\n    question_id = '',\n    answer_id = '',\n    comment_id = '',\n    url_title = '',\n  } = data;\n  let itemLink = '';\n  let itemId = '';\n  let itemTimePrefix = '';\n\n  if (object_type === 'question') {\n    itemLink = pathFactory.questionLanding(String(object_id), url_title);\n    itemId = String(question_id);\n    itemTimePrefix = 'asked';\n  } else if (object_type === 'answer') {\n    itemLink = pathFactory.answerLanding({\n      // @ts-ignore\n      questionId: question_id,\n      slugTitle: url_title,\n      answerId: String(object_id),\n    });\n    itemId = String(object_id);\n    itemTimePrefix = 'answered';\n  } else if (object_type === 'comment') {\n    if (question_id && answer_id) {\n      itemLink = `${pathFactory.answerLanding({\n        questionId: question_id,\n        slugTitle: url_title,\n        answerId: answer_id,\n      })}?commentId=${comment_id}`;\n    } else {\n      itemLink = `${pathFactory.questionLanding(\n        String(question_id),\n        url_title,\n      )}?commentId=${comment_id}`;\n    }\n    itemId = String(comment_id);\n    itemTimePrefix = 'commented';\n  }\n\n  return {\n    itemLink,\n    itemId,\n    itemTimePrefix,\n  };\n};\n"],"names":["Index","refreshCount","_flagItemData$tags","_ADMIN_LIST_STATUS$ob","_ADMIN_LIST_STATUS$ob2","urlSearch","setUrlSearchParams","useSearchParams","objectId","get","t","useTranslation","keyPrefix","ref","useRef","noTasks","setNoTasks","useState","isLoading","setIsLoading","page","setPage","reviewResp","setReviewResp","flagItemData","list","queryNextOne","pageNumber","id","getPendingReviewPostList","then","resp","resolveNextOne","count","length","setTimeout","scrollToDocTop","useEffect","current","htmlRender","handleAction","type","putPendingReviewAction","status","review_id","delete","finally","object_type","author_user_info","object_status","reason","itemLink","itemId","itemTimePrefix","generateData","_jsxs","Card","children","_jsx","Header","Body","className","Alert","variant","Stack","direction","gap","Icon","name","size","submitter_display_name","submit_at","FormatTime","time","preFix","Link","to","target","_Fragment","title","tags","map","item","Tag","data","slug_name","ImgViewer","dangerouslySetInnerHTML","__html","parsed_text","classNames","ADMIN_LIST_STATUS","object_show_status","unlisted","BaseUserCard","avatarSize","avatarClass","Number","created_at","Footer","Button","disabled","onClick","handlingSkip","object_id","question_id","answer_id","comment_id","url_title","pathFactory","questionLanding","String","answerLanding","questionId","slugTitle","answerId"],"sourceRoot":""}