{"version":3,"file":"static/js/3336.0f4717a7.chunk.js","mappings":"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","sources":["pages/Questions/Detail/components/Question/index.tsx"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { memo, FC, useState, useEffect, useRef } from 'react';\nimport { Link, useSearchParams } from 'react-router-dom';\nimport { useTranslation } from 'react-i18next';\nimport { Button, OverlayTrigger, Tooltip } from 'react-bootstrap';\n\nimport {\n  Tag,\n  Actions,\n  Operate,\n  UserCard,\n  Comment,\n  FormatTime,\n  htmlRender,\n  Icon,\n  ImgViewer,\n} from '@/components';\nimport { useRenderHtmlPlugin } from '@/utils/pluginKit';\nimport { formatCount, guard } from '@/utils';\nimport { following } from '@/services';\nimport {\n  getUrlQuestionType,\n  needQuestionToLoginOrUp,\n} from '@/common/functions';\nimport IntegralLink from '@/components/IntegralLink';\nimport { isModerator } from '@/common/constants';\nimport { loggedUserInfoStore } from '@/stores';\n\ninterface Props {\n  data: any;\n  hasAnswer: boolean;\n  isLogged: boolean;\n  initPage: (type: string) => void;\n}\n\nconst Index: FC<Props> = ({ data, initPage, hasAnswer, isLogged }) => {\n  const { t } = useTranslation('translation', {\n    keyPrefix: 'question_detail',\n  });\n  const [searchParams] = useSearchParams();\n  // const navigate = useNavigate();\n  const [followed, setFollowed] = useState(data?.is_followed);\n  const ref = useRef<HTMLDivElement>(null);\n  const contentType = getUrlQuestionType();\n  useRenderHtmlPlugin(ref.current);\n  const userInfo = loggedUserInfoStore((state) => state.user);\n  const handleFollow = (e) => {\n    e.preventDefault();\n    if (!guard.tryNormalLogged(true)) {\n      return;\n    }\n    following({\n      object_id: data?.id,\n      is_cancel: followed,\n    }).then((res) => {\n      setFollowed(res.is_followed);\n    });\n  };\n\n  useEffect(() => {\n    if (data) {\n      setFollowed(data?.is_followed);\n    }\n  }, [data]);\n\n  useEffect(() => {\n    if (!ref.current) {\n      return;\n    }\n\n    htmlRender(ref.current);\n  }, [ref.current]);\n\n  if (!data?.id || data?.id === '0') {\n    return null;\n  }\n  needQuestionToLoginOrUp(data, userInfo);\n  return (\n    <div>\n      <h1 className=\"h3 mb-3 text-wrap text-break\">\n        {data?.pin === 2 && (\n          <Icon\n            name=\"pin-fill\"\n            className=\"me-1\"\n            title={t('pinned', { keyPrefix: 'btns' })}\n          />\n        )}\n        <div className=\"link-dark\">\n          {data.title}\n          <IntegralLink\n            score={data.score}\n            t={t}\n            contentType={contentType}\n            isPay={\n              isModerator(data, userInfo) ||\n              (!!userInfo.id && data.buyer_user_ids.indexOf(userInfo.id) !== -1)\n            }\n          />\n          {data.status === 2\n            ? ` [${t('closed', { keyPrefix: 'question' })}]`\n            : ''}\n        </div>\n      </h1>\n\n      <div className=\"d-flex flex-wrap align-items-center small mb-3 text-secondary\">\n        <FormatTime\n          time={data.create_time}\n          preFix={t('Asked')}\n          className=\"me-3\"\n        />\n\n        <FormatTime\n          time={data.update_time}\n          preFix={t('update')}\n          className=\"me-3\"\n        />\n        {data?.view_count > 0 && (\n          <div className=\"me-3\">\n            {t('Views')} {formatCount(data.view_count)}\n          </div>\n        )}\n        <OverlayTrigger\n          placement=\"bottom\"\n          overlay={<Tooltip id=\"followTooltip\">{t('follow_tip')}</Tooltip>}>\n          <Button\n            variant=\"link\"\n            size=\"sm\"\n            className=\"p-0 btn-no-border\"\n            onClick={(e) => handleFollow(e)}>\n            {t(followed ? 'Following' : 'Follow')}\n          </Button>\n        </OverlayTrigger>\n      </div>\n      <div className=\"m-n1\">\n        {data?.tags?.map((item: any) => {\n          return <Tag className=\"m-1\" key={item.slug_name} data={item} />;\n        })}\n      </div>\n      <ImgViewer>\n        <article\n          ref={ref}\n          className=\"fmt text-break text-wrap mt-4\"\n          dangerouslySetInnerHTML={{ __html: data?.html }}\n        />\n      </ImgViewer>\n\n      <Actions\n        className=\"mt-4\"\n        source=\"question\"\n        data={{\n          id: data?.id,\n          isHate: data?.vote_status === 'vote_down',\n          isLike: data?.vote_status === 'vote_up',\n          votesCount: data?.vote_count,\n          collected: data?.collected,\n          collectCount: data?.collection_count,\n          username: data.user_info?.username,\n        }}\n      />\n\n      <div className=\"d-block d-md-flex flex-wrap mt-4 mb-3\">\n        <div className=\"mb-3 mb-md-0 me-4 flex-grow-1\">\n          <Operate\n            qid={data?.id}\n            type=\"question\"\n            score={data.score}\n            memberActions={data?.member_actions}\n            title={data.title}\n            hasAnswer={hasAnswer}\n            isAccepted={Boolean(data?.accepted_answer_id !== '0')}\n            callback={initPage}\n          />\n        </div>\n        <div style={{ minWidth: '196px' }} className=\"mb-3 me-4 mb-md-0\">\n          {data.update_user_info &&\n          data.update_user_info?.username !== data.user_info?.username ? (\n            <UserCard\n              data={data?.update_user_info}\n              time={data.edit_time}\n              preFix={t('edit')}\n              isLogged={isLogged}\n              timelinePath={`/posts/${data.id}/timeline?content_type=${contentType}`}\n            />\n          ) : isLogged ? (\n            <Link to={`/posts/${data.id}/timeline?content_type=${contentType}`}>\n              <FormatTime\n                time={data.edit_time}\n                preFix={t('edit')}\n                className=\"link-secondary small\"\n              />\n            </Link>\n          ) : (\n            <FormatTime\n              time={data.edit_time}\n              preFix={t('edit')}\n              className=\"text-secondary small\"\n            />\n          )}\n        </div>\n        <div style={{ minWidth: '196px' }}>\n          <UserCard\n            data={data?.user_info}\n            time={data.create_time}\n            preFix={t('asked')}\n            isLogged={isLogged}\n            timelinePath={`/posts/${data.id}/timeline`}\n          />\n        </div>\n      </div>\n\n      <Comment\n        objectId={data?.id}\n        mode=\"question\"\n        commentId={searchParams.get('commentId')}\n      />\n    </div>\n  );\n};\n\nexport default memo(Index);\n"],"names":["Index","data","initPage","hasAnswer","isLogged","_data$tags","_data$user_info","_data$update_user_inf","_data$user_info2","t","useTranslation","keyPrefix","searchParams","useSearchParams","followed","setFollowed","useState","is_followed","ref","useRef","contentType","getUrlQuestionType","useRenderHtmlPlugin","current","userInfo","loggedUserInfoStore","state","user","useEffect","htmlRender","id","needQuestionToLoginOrUp","_jsxs","children","className","pin","_jsx","Icon","name","title","IntegralLink","score","isPay","isModerator","buyer_user_ids","indexOf","status","FormatTime","time","create_time","preFix","update_time","view_count","formatCount","OverlayTrigger","placement","overlay","Tooltip","Button","variant","size","onClick","e","preventDefault","guard","following","object_id","is_cancel","then","res","handleFollow","tags","map","item","Tag","slug_name","ImgViewer","dangerouslySetInnerHTML","__html","html","Actions","source","isHate","vote_status","isLike","votesCount","vote_count","collected","collectCount","collection_count","username","user_info","Operate","qid","type","memberActions","member_actions","isAccepted","Boolean","accepted_answer_id","callback","style","minWidth","update_user_info","UserCard","edit_time","timelinePath","Link","to","Comment","objectId","mode","commentId","get","memo"],"sourceRoot":""}