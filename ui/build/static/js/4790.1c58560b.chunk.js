"use strict";(globalThis.webpackChunkanswer_static=globalThis.webpackChunkanswer_static||[]).push([[4790,6990,1772],{44790:(e,t,l)=>{l.r(t),l.d(t,{default:()=>x});var a=l(28915),s=l(97095),n=l(46261),i=l(53799),r=l(51588),o=l(14577),d=l.n(o),c=l(48058),u=l(47185),v=l(25831),g=l(81801),h=l(4440),f=(l(36990),l(68179));const m={title:{value:"",isInvalid:!1,errorMsg:""},tags:{value:[],isInvalid:!1,errorMsg:""},content:{value:"",isInvalid:!1,errorMsg:""}},x=({originalData:e,visible:t=!1,objectType:l,handleClose:o,callback:x})=>{const{t:p}=(0,r.B)("translation",{keyPrefix:"ask"}),[b,y]=(0,a.useState)(m),[j,I]=(0,a.useState)(!1),[k,A]=(0,a.useState)(!1),C=(0,u.L7)(),M=(0,v.T5)("edit"),_=e=>{e&&(null===x||void 0===x||x()),y(m),o(),A(!1)},w=e=>{k&&y({...b,...e})},N=()=>{const t={title:b.title.value,content:b.content.value,tags:b.tags.value,operation_type:"edit_post",flag_id:e.flag_id};if("answer"===l&&(delete t.title,delete t.tags),"comment"===l){const{value:e}=b.content,l=(0,h.by)(e);t.content=l,delete t.title,delete t.tags}if("question"===l){const e=null===M||void 0===M?void 0:M.getCaptcha();null!==e&&void 0!==e&&e.verify&&(t.captcha_code=e.captcha_code,t.captcha_id=e.captcha_id)}(0,c.gI)(t).then((async()=>{await(null===M||void 0===M?void 0:M.close()),_(!0)})).catch((e=>{if(e.isError){null===M||void 0===M||M.handleCaptchaError(e.list);const t=(0,h.NC)(e,b);y({...t});const l=document.getElementById(e.list[0].error_field);(0,h.qt)(l)}}))};return(0,a.useEffect)((()=>{t&&(b.title.value=e.title,b.content.value=e.content,b.tags.value=e.tags.map((e=>({...e,parsed_text:"",original_text:""}))),y({...b}),A(!0))}),[t]),(0,f.jsxs)(s.A,{show:t,onHide:()=>_(!1),className:"w-100",dialogClassName:"edit-post-modal",children:[(0,f.jsx)(s.A.Header,{closeButton:!0,children:(0,f.jsx)(s.A.Title,{children:p("edit_post",{keyPrefix:"page_review"})})}),(0,f.jsxs)(n.A,{noValidate:!0,onSubmit:e=>{e.preventDefault(),e.stopPropagation(),(()=>{let e=!0;const{title:t,tags:a,content:s}=b;if("question"===l&&(t.value||(e=!1,b.title={value:t.value,isInvalid:!0,errorMsg:p("form.fields.title.msg.empty",{keyPrefix:"ask"})}),a.value.length||(e=!1,b.tags={value:a.value,isInvalid:!0,errorMsg:p("form.fields.tags.msg.empty",{keyPrefix:"ask"})})),!s.value||Array.from(s.value.trim()).length<6?(e=!1,b.content={value:s.value,isInvalid:!0,errorMsg:p("form.fields.answer.feedback.characters",{keyPrefix:"edit_answer"})}):b.content={value:s.value,isInvalid:!1,errorMsg:""},y({...b}),!e){const e=Object.keys(b).filter((e=>b[e].isInvalid)),t=document.getElementById(e[0]);(0,h.qt)(t)}return e})()&&(M?M.check((()=>N())):N())},children:[(0,f.jsxs)(s.A.Body,{children:["question"===l&&(0,f.jsxs)(n.A.Group,{controlId:"title",className:"mb-3",children:[(0,f.jsx)(n.A.Label,{children:p("form.fields.title.label")}),(0,f.jsx)(n.A.Control,{type:"text",value:b.title.value,isInvalid:b.title.isInvalid,onChange:e=>{w({title:{value:e.target.value,isInvalid:!1,errorMsg:""}})},placeholder:p("form.fields.title.placeholder"),autoFocus:!0,contentEditable:!0}),(0,f.jsx)(n.A.Control.Feedback,{type:"invalid",children:b.title.errorMsg})]}),"comment"!==l&&(0,f.jsxs)(n.A.Group,{controlId:"body",children:[(0,f.jsx)(n.A.Label,{children:p("question"===l?"form.fields.body.label":"form.fields.answer.label")}),(0,f.jsx)(n.A.Control,{defaultValue:b.content.value,isInvalid:b.content.isInvalid,hidden:!0}),(0,f.jsx)(g.KE,{value:b.content.value,onChange:e=>{w({content:{value:e,errorMsg:"",isInvalid:!1}})},className:d()("form-control p-0",j?"focus":""),onFocus:()=>{I(!0)},onBlur:()=>{I(!1)}}),(0,f.jsx)(n.A.Control.Feedback,{type:"invalid",children:b.content.errorMsg})]}),"question"===l&&(0,f.jsxs)(n.A.Group,{controlId:"tags",className:"my-3",children:[(0,f.jsx)(n.A.Label,{children:p("form.fields.tags.label")}),(0,f.jsx)(n.A.Control,{defaultValue:JSON.stringify(b.tags.value),isInvalid:b.tags.isInvalid,hidden:!0}),(0,f.jsx)(g.Cx,{value:b.tags.value,onChange:e=>{w({tags:{value:e,errorMsg:"",isInvalid:!1}})},showRequiredTag:!0,maxTagLength:5}),(0,f.jsx)(n.A.Control.Feedback,{type:"invalid",children:b.tags.errorMsg})]}),"comment"===l&&(0,f.jsxs)("div",{className:"w-100",children:[(0,f.jsxs)("div",{className:d()("custom-form-control",{"is-invalid":b.content.isInvalid}),children:[(0,f.jsx)(n.A.Label,{children:"Comment"}),(0,f.jsx)(g.MW,{pageUsers:C.getUsers(),onSelected:e=>{k&&y({...b,content:{value:e,errorMsg:"",isInvalid:!1}})},children:(0,f.jsx)(g.fs,{size:"sm",rows:4,value:(0,h.$t)(b.content.value),onChange:e=>{w({content:{value:e.target.value,errorMsg:"",isInvalid:!1}})}})})]}),(0,f.jsx)(n.A.Control.Feedback,{type:"invalid",children:b.content.errorMsg})]})]}),(0,f.jsxs)(s.A.Footer,{children:[(0,f.jsx)(i.A,{variant:"secondary",onClick:()=>_(!1),children:p("close",{keyPrefix:"btns"})}),(0,f.jsx)(i.A,{variant:"primary",type:"submit",children:p("submit",{keyPrefix:"btns"})})]})]})]})}},36990:(e,t,l)=>{l.r(t),l.d(t,{default:()=>a});const a={}}}]);
//# sourceMappingURL=4790.1c58560b.chunk.js.map