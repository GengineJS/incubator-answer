"use strict";(globalThis.webpackChunkanswer_static=globalThis.webpackChunkanswer_static||[]).push([[3075,499],{93075:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var l=n(28915),s=n(13015),a=n(98329),i=n(46261),r=n(53799),o=n(16413),c=n(18596),d=n(51588),u=n(17534),v=n.n(u),m=n(14577),h=n.n(m),f=n(4440),p=n(47185),x=n(25831),g=n(34202),_=n(81801),j=n(48058),y=(n(80499),n(68179));const w=()=>{var e,t;const{aid:n="",qid:u=""}=(0,c.g)(),[m,w]=(0,l.useState)("");(0,l.useLayoutEffect)((()=>{(0,f.Mv)()}),[]);const{t:b}=(0,d.B)("translation",{keyPrefix:"edit_answer"}),A=(0,c.Zp)(),N={content:{value:"",isInvalid:!1,errorMsg:""},description:{value:"",isInvalid:!1,errorMsg:""}},{data:I}=(0,j.gy)(n),[k,C]=(0,l.useState)(N),[q,M]=(0,l.useState)(N),[E,L]=(0,l.useState)(!1),S=(0,x.T5)("edit");(0,l.useEffect)((()=>{var e;null!==I&&void 0!==I&&null!==(e=I.info)&&void 0!==e&&e.content&&C({...k,content:{value:I.info.content,isInvalid:!1,errorMsg:""}})}),[null===I||void 0===I||null===(e=I.info)||void 0===e?void 0:e.content]);const{data:H=[]}=(0,j.Of)(n),T=(0,l.useRef)({getHtml:()=>""}),P=(0,l.useRef)(null);(0,x.e9)(P.current),(0,l.useEffect)((()=>{null!==P&&void 0!==P&&P.current&&(0,_._A)(P.current)}),[P]),(0,p.XB)({when:E}),(0,l.useEffect)((()=>{const{content:e,description:t}=k;q.content.value!==e.value||t.value?L(!0):L(!1)}),[k.content.value,k.description.value]);const B=()=>{const e={content:k.content.value,html:T.current.getHtml(),question_id:u,id:n,edit_summary:k.description.value};null===S||void 0===S||S.resolveCaptchaReq(e),(0,j.lw)(e).then((async e=>{var t;await(null===S||void 0===S?void 0:S.close()),A(g.w.answerLanding({questionId:u,slugTitle:null===I||void 0===I||null===(t=I.question)||void 0===t?void 0:t.url_title,answerId:n}),{state:{isReview:null===e||void 0===e?void 0:e.wait_for_review}})})).catch((e=>{if(e.isError){null===S||void 0===S||S.handleCaptchaError(e.list);const t=(0,f.NC)(e,k);C({...t})}}))};return(0,p.M4)({title:b("edit_answer",{keyPrefix:"page_title"})}),(0,y.jsxs)("div",{className:"pt-4 mb-5 edit-answer-wrap",children:[(0,y.jsx)("h3",{className:"mb-4",children:b("title")}),(0,y.jsxs)(s.A,{children:[(0,y.jsxs)(a.A,{className:"page-main flex-auto",children:[(0,y.jsx)("a",{href:g.w.questionLanding(u,null===I||void 0===I?void 0:I.question.url_title,null===I||void 0===I?void 0:I.question.content_type),target:"_blank",rel:"noreferrer",children:(0,y.jsx)("h5",{className:"mb-3",children:null===I||void 0===I?void 0:I.question.title})}),(0,y.jsxs)("div",{className:"question-content-wrap",children:[(0,y.jsx)("div",{ref:P,className:"content position-absolute top-0 w-100",dangerouslySetInnerHTML:{__html:null===I||void 0===I?void 0:I.question.html}}),(0,y.jsx)("div",{className:"resize-bottom",style:{maxHeight:null===P||void 0===P||null===(t=P.current)||void 0===t?void 0:t.scrollHeight}}),(0,y.jsx)("div",{className:"line bg-light  d-flex justify-content-center align-items-center",children:(0,y.jsx)(_.In,{type:"bi",name:"grip-horizontal",className:"mt-1"})})]}),(0,y.jsxs)(i.A,{noValidate:!0,onSubmit:async e=>{L(!1),e.preventDefault(),e.stopPropagation(),(()=>{let e=!0;const{content:t}=k;return!t.value||Array.from(t.value.trim()).length<6?(e=!1,k.content={value:t.value,isInvalid:!0,errorMsg:b("form.fields.answer.feedback.characters")}):k.content={value:t.value,isInvalid:!1,errorMsg:""},C({...k}),e})()&&(S?S.check((()=>B())):B())},children:[(0,y.jsxs)(i.A.Group,{controlId:"revision",className:"mb-3",children:[(0,y.jsx)(i.A.Label,{children:b("form.fields.revision.label")}),(0,y.jsx)(i.A.Select,{onChange:e=>{const t=e.target.value,n=H[t];null!==n&&void 0!==n&&n.content&&(k.content.value=n.content.content,M({...k}),C({...k}))},defaultValue:0,children:H.map((({create_at:e,reason:t,user_info:n},l)=>{const s=v()(1e3*e).tz().format(b("long_date_with_time",{keyPrefix:"dates"}));return(0,y.jsx)("option",{value:l,children:`${s} - ${n.display_name} - ${t||(l===H.length-1?b("default_first_reason"):b("default_reason"))}`},`${e}`)}))})]}),(0,y.jsxs)(i.A.Group,{controlId:"answer",className:"mt-3",children:[(0,y.jsx)(i.A.Label,{children:b("form.fields.answer.label")}),(0,y.jsx)(_.KE,{value:k.content.value,onChange:e=>C({...k,content:{...k.content,value:e}}),className:h()("form-control p-0","answer"===m&&"focus"),onFocus:()=>{w("answer")},onBlur:()=>{w("")},ref:T}),(0,y.jsx)(i.A.Control,{value:k.content.value,type:"text",isInvalid:k.content.isInvalid,readOnly:!0,hidden:!0}),(0,y.jsx)(i.A.Control.Feedback,{type:"invalid",children:k.content.errorMsg})]}),(0,y.jsxs)(i.A.Group,{controlId:"edit_summary",className:"my-3",children:[(0,y.jsx)(i.A.Label,{children:b("form.fields.edit_summary.label")}),(0,y.jsx)(i.A.Control,{type:"text",onChange:e=>{const t=e.currentTarget.value;C({...k,description:{...k.description,value:t}})},defaultValue:k.description.value,isInvalid:k.description.isInvalid,placeholder:b("form.fields.edit_summary.placeholder"),contentEditable:!0}),(0,y.jsx)(i.A.Control.Feedback,{type:"invalid",children:k.description.errorMsg})]}),(0,y.jsxs)("div",{className:"mt-3",children:[(0,y.jsx)(r.A,{type:"submit",className:"me-2",children:b("btn_save_edits")}),(0,y.jsx)(r.A,{variant:"link",onClick:()=>{A(-1)},children:b("btn_cancel")})]})]})]}),(0,y.jsx)(a.A,{className:"page-right-side mt-4 mt-xl-0",children:(0,y.jsxs)(o.A,{children:[(0,y.jsx)(o.A.Header,{children:b("title",{keyPrefix:"how_to_format"})}),(0,y.jsx)(o.A.Body,{className:"fmt small",dangerouslySetInnerHTML:{__html:b("desc",{keyPrefix:"how_to_format"})}})]})})]})]})}},80499:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});const l={}}}]);
//# sourceMappingURL=3075.46de2620.chunk.js.map