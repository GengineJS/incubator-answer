{"version":3,"file":"static/js/8462.db17837e.chunk.js","mappings":"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","sources":["pages/Questions/Detail/components/Answer/index.tsx"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { memo, FC, useEffect, useRef } from 'react';\nimport { Button, Alert, Badge } from 'react-bootstrap';\nimport { useTranslation } from 'react-i18next';\nimport { Link, useSearchParams } from 'react-router-dom';\n\nimport {\n  Actions,\n  Operate,\n  UserCard,\n  Icon,\n  Comment,\n  FormatTime,\n  htmlRender,\n  ImgViewer,\n  Modal,\n} from '@/components';\nimport { scrollToElementTop, bgFadeOut } from '@/utils';\nimport { AnswerItem } from '@/common/interface';\nimport { acceptanceAnswer } from '@/services';\nimport { useRenderHtmlPlugin } from '@/utils/pluginKit';\nimport { PayContentType } from '@/common/constants';\nimport { getUrlQuestionType } from '@/common/functions';\n\ninterface Props {\n  data: AnswerItem;\n  /** router answer id */\n  aid?: string;\n  acceptedId?: string;\n  canAccept: boolean;\n  score?: number;\n  questionTitle: string;\n  isLogged: boolean;\n  callback: (type: string) => void;\n}\nconst Index: FC<Props> = ({\n  aid,\n  data,\n  acceptedId,\n  isLogged,\n  score = 0,\n  questionTitle = '',\n  callback,\n  canAccept = false,\n}) => {\n  const contentType = getUrlQuestionType();\n  const isPayType = PayContentType.indexOf(contentType) !== -1;\n  const isScoreContent = score && isPayType;\n  const hasAccepted = acceptedId !== '0' && isScoreContent;\n  if (hasAccepted) {\n    canAccept = data.accepted === 2;\n  }\n  const { t } = useTranslation('translation', {\n    keyPrefix: 'question_detail',\n  });\n\n  const [searchParams] = useSearchParams();\n  const answerRef = useRef<HTMLDivElement>(null);\n  useRenderHtmlPlugin(answerRef.current);\n  const isAccepted = data?.accepted === 2;\n  const acceptAnswer = () => {\n    if (isScoreContent) {\n      Modal.confirm({\n        title: t('accept_title'),\n        content: isAccepted ? t('not_accept') : t('warn_accept'),\n        cancelBtnVariant: 'link',\n        confirmBtnVariant: 'danger',\n        confirmText: isAccepted ? t('ok') : t('accept'),\n        onConfirm: () => {\n          if (isAccepted) return;\n          acceptanceAnswer({\n            question_id: data.question_id,\n            answer_id: data.accepted === 2 ? '0' : data.id,\n            score: isScoreContent ? score : 0,\n          }).then(() => {\n            callback?.('');\n          });\n        },\n      });\n      return;\n    }\n    acceptanceAnswer({\n      question_id: data.question_id,\n      answer_id: data.accepted === 2 ? '0' : data.id,\n    }).then(() => {\n      callback?.('');\n    });\n  };\n\n  useEffect(() => {\n    if (!answerRef?.current) {\n      return;\n    }\n\n    htmlRender(answerRef.current.querySelector('.fmt'));\n\n    if (aid === data.id) {\n      setTimeout(() => {\n        const element = answerRef.current;\n        scrollToElementTop(element);\n        if (!searchParams.get('commentId')) {\n          bgFadeOut(answerRef.current);\n        }\n      }, 100);\n    }\n  }, [data.id, answerRef.current]);\n\n  if (!data?.id) {\n    return null;\n  }\n\n  return (\n    <div id={data.id} ref={answerRef} className=\"answer-item py-4\">\n      {data.status === 10 && (\n        <Alert variant=\"danger\" className=\"mb-4\">\n          {t('post_deleted', { keyPrefix: 'messages' })}\n        </Alert>\n      )}\n      {data.status === 11 && (\n        <Alert variant=\"secondary\" className=\"mb-4\">\n          {t('post_pending', { keyPrefix: 'messages' })}\n        </Alert>\n      )}\n\n      {isAccepted && (\n        <div className=\"mb-3 lh-1\">\n          <Badge bg=\"success\" pill>\n            <Icon name=\"check-circle-fill me-1\" />\n            {t('best_answer')}\n          </Badge>\n        </div>\n      )}\n      <ImgViewer>\n        <article\n          className=\"fmt text-break text-wrap\"\n          dangerouslySetInnerHTML={{ __html: data?.html }}\n        />\n        {data.is_ai && (\n          <div className=\"fmt fs-7 small text-secondary text-break text-wrap\">\n            ({t('ai_commented')})\n          </div>\n        )}\n      </ImgViewer>\n      <div className=\"d-flex align-items-center mt-4\">\n        <Actions\n          source=\"answer\"\n          data={{\n            id: data?.id,\n            isHate: data?.vote_status === 'vote_down',\n            isLike: data?.vote_status === 'vote_up',\n            votesCount: data?.vote_count,\n            hideCollect: true,\n            collected: data?.collected,\n            collectCount: 0,\n            username: data?.user_info?.username,\n          }}\n        />\n\n        {canAccept && (\n          <Button\n            variant={data.accepted === 2 ? 'success' : 'outline-success'}\n            className=\"ms-3\"\n            onClick={acceptAnswer}>\n            <Icon name=\"check-circle-fill\" className=\"me-2\" />\n            <span>\n              {data.accepted === 2\n                ? t('answers.btn_accepted')\n                : t('answers.btn_accept')}\n            </span>\n          </Button>\n        )}\n      </div>\n\n      <div className=\"d-block d-md-flex flex-wrap mt-4 mb-3\">\n        <div className=\"mb-3 mb-md-0 me-4 flex-grow-1\">\n          <Operate\n            qid={data.question_id}\n            aid={data.id}\n            score={score}\n            memberActions={data?.member_actions}\n            type=\"answer\"\n            isAccepted={data.accepted === 2}\n            title={questionTitle}\n            callback={callback}\n          />\n        </div>\n        <div className=\"mb-3 mb-md-0 me-4\" style={{ minWidth: '196px' }}>\n          {data.update_user_info &&\n          data.update_user_info?.username !== data.user_info?.username ? (\n            <UserCard\n              data={data?.update_user_info}\n              time={Number(data.update_time)}\n              preFix={t('edit')}\n              isLogged={isLogged}\n              timelinePath={`/posts/${data.question_id}/${data.id}/timeline`}\n            />\n          ) : isLogged ? (\n            <Link to={`/posts/${data.question_id}/${data.id}/timeline`}>\n              <FormatTime\n                time={Number(data.update_time)}\n                preFix={t('edit')}\n                className=\"link-secondary small\"\n              />\n            </Link>\n          ) : (\n            <FormatTime\n              time={Number(data.update_time)}\n              preFix={t('edit')}\n              className=\"text-secondary small\"\n            />\n          )}\n        </div>\n        <div style={{ minWidth: '196px' }}>\n          <UserCard\n            data={data?.user_info}\n            time={Number(data.create_time)}\n            preFix={t('answered')}\n            isLogged={isLogged}\n            timelinePath={`/posts/${data.question_id}/${data.id}/timeline`}\n          />\n        </div>\n      </div>\n\n      <Comment\n        objectId={data.id}\n        isObjectAI={data.is_ai}\n        mode=\"answer\"\n        commentId={searchParams.get('commentId')}\n      />\n    </div>\n  );\n};\n\nexport default memo(Index);\n"],"names":["Index","aid","data","acceptedId","isLogged","score","questionTitle","callback","canAccept","_data$user_info","_data$update_user_inf","_data$user_info2","contentType","getUrlQuestionType","isPayType","PayContentType","indexOf","isScoreContent","accepted","t","useTranslation","keyPrefix","searchParams","useSearchParams","answerRef","useRef","useRenderHtmlPlugin","current","isAccepted","useEffect","htmlRender","querySelector","id","setTimeout","element","scrollToElementTop","get","bgFadeOut","_jsxs","ref","className","children","status","_jsx","Alert","variant","Badge","bg","pill","Icon","name","ImgViewer","dangerouslySetInnerHTML","__html","html","is_ai","Actions","source","isHate","vote_status","isLike","votesCount","vote_count","hideCollect","collected","collectCount","username","user_info","Button","onClick","acceptAnswer","Modal","confirm","title","content","cancelBtnVariant","confirmBtnVariant","confirmText","onConfirm","acceptanceAnswer","question_id","answer_id","then","Operate","qid","memberActions","member_actions","type","style","minWidth","update_user_info","UserCard","time","Number","update_time","preFix","timelinePath","Link","to","FormatTime","create_time","Comment","objectId","isObjectAI","mode","commentId","memo"],"sourceRoot":""}