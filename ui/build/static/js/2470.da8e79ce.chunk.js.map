{"version":3,"file":"static/js/2470.da8e79ce.chunk.js","mappings":"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","sources":["pages/Users/Register/components/SignUpForm/index.tsx","behaviour/useLegalClick.tsx"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { FormEvent, useState } from 'react';\nimport { Form, Button } from 'react-bootstrap';\nimport { Link } from 'react-router-dom';\nimport { Trans, useTranslation } from 'react-i18next';\n\nimport { useCaptchaPlugin } from '@/utils/pluginKit';\nimport type { FormDataType, RegisterReqParams } from '@/common/interface';\nimport { register } from '@/services';\nimport userStore from '@/stores/loggedUserInfo';\nimport { handleFormError, scrollToElementTop } from '@/utils';\nimport { useLegalClick } from '@/behaviour/useLegalClick';\nimport { isAssetBunPageType } from '@/common/functions';\nimport { assetBunPolicyUrl, assetBunPrivateUrl } from '@/common/constants';\n\ninterface Props {\n  callback: () => void;\n}\n\nconst Index: React.FC<Props> = ({ callback }) => {\n  const { t } = useTranslation('translation', { keyPrefix: 'login' });\n  const [formData, setFormData] = useState<FormDataType>({\n    name: {\n      value: '',\n      isInvalid: false,\n      errorMsg: '',\n    },\n    e_mail: {\n      value: '',\n      isInvalid: false,\n      errorMsg: '',\n    },\n    pass: {\n      value: '',\n      isInvalid: false,\n      errorMsg: '',\n    },\n  });\n\n  const updateUser = userStore((state) => state.update);\n  const emailCaptcha = useCaptchaPlugin('email');\n\n  const handleChange = (params: FormDataType) => {\n    setFormData({ ...formData, ...params });\n  };\n\n  const checkValidated = (): boolean => {\n    let bol = true;\n    const { e_mail, pass } = formData;\n\n    if (!e_mail.value) {\n      bol = false;\n      formData.e_mail = {\n        value: '',\n        isInvalid: true,\n        errorMsg: t('email.msg.empty'),\n      };\n    }\n\n    if (!pass.value) {\n      bol = false;\n      formData.pass = {\n        value: '',\n        isInvalid: true,\n        errorMsg: t('password.msg.empty'),\n      };\n    }\n    setFormData({\n      ...formData,\n    });\n    if (!bol) {\n      const errObj = Object.keys(formData).filter(\n        (key) => formData[key].isInvalid,\n      );\n      const ele = document.getElementById(errObj[0]);\n      scrollToElementTop(ele);\n    }\n    return bol;\n  };\n\n  const legalClick = useLegalClick();\n\n  const handleRegister = (event?: any) => {\n    if (event) {\n      event.preventDefault();\n    }\n    const reqParams: RegisterReqParams = {\n      name: formData.name.value,\n      e_mail: formData.e_mail.value,\n      pass: formData.pass.value,\n      is_ab: isAssetBunPageType(),\n    };\n\n    const captcha = emailCaptcha?.getCaptcha();\n    if (captcha?.verify) {\n      reqParams.captcha_code = captcha.captcha_code;\n      reqParams.captcha_id = captcha.captcha_id;\n    }\n\n    register(reqParams)\n      .then(async (res) => {\n        await emailCaptcha?.close();\n        updateUser(res);\n        callback();\n      })\n      .catch((err) => {\n        if (err.isError) {\n          emailCaptcha?.handleCaptchaError(err.list);\n          const data = handleFormError(err, formData);\n          setFormData({ ...data });\n          const ele = document.getElementById(err.list[0].error_field);\n          scrollToElementTop(ele);\n        }\n      });\n  };\n\n  const handleSubmit = async (event: FormEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (!checkValidated()) {\n      return;\n    }\n    if (!emailCaptcha) {\n      handleRegister();\n      return;\n    }\n    emailCaptcha.check(() => {\n      handleRegister();\n    });\n  };\n  const isAssetBun = isAssetBunPageType();\n  const privatesUrl = isAssetBun ? assetBunPrivateUrl : '/privacy';\n  const policyUrl = isAssetBun ? assetBunPolicyUrl : '/tos';\n  return (\n    <>\n      <Form noValidate onSubmit={handleSubmit} autoComplete=\"off\">\n        <Form.Group controlId=\"name\" className=\"mb-3\">\n          <Form.Label>{t('name.label')}</Form.Label>\n          <Form.Control\n            autoComplete=\"off\"\n            required\n            type=\"text\"\n            isInvalid={formData.name.isInvalid}\n            value={formData.name.value}\n            onChange={(e) =>\n              handleChange({\n                name: {\n                  value: e.target.value,\n                  isInvalid: false,\n                  errorMsg: '',\n                },\n              })\n            }\n          />\n          <Form.Control.Feedback type=\"invalid\">\n            {formData.name.errorMsg}\n          </Form.Control.Feedback>\n        </Form.Group>\n        <Form.Group controlId=\"email\" className=\"mb-3\">\n          <Form.Label>{t('email.label')}</Form.Label>\n          <Form.Control\n            autoComplete=\"off\"\n            required\n            type=\"e_mail\"\n            isInvalid={formData.e_mail.isInvalid}\n            value={formData.e_mail.value}\n            onChange={(e) =>\n              handleChange({\n                e_mail: {\n                  value: e.target.value,\n                  isInvalid: false,\n                  errorMsg: '',\n                },\n              })\n            }\n          />\n          <Form.Control.Feedback type=\"invalid\">\n            {formData.e_mail.errorMsg}\n          </Form.Control.Feedback>\n        </Form.Group>\n\n        <Form.Group controlId=\"password\" className=\"mb-3\">\n          <Form.Label>{t('password.label')}</Form.Label>\n          <Form.Control\n            autoComplete=\"off\"\n            required\n            type=\"password\"\n            isInvalid={formData.pass.isInvalid}\n            value={formData.pass.value}\n            onChange={(e) =>\n              handleChange({\n                pass: {\n                  value: e.target.value,\n                  isInvalid: false,\n                  errorMsg: '',\n                },\n              })\n            }\n          />\n          <Form.Control.Feedback type=\"invalid\">\n            {formData.pass.errorMsg}\n          </Form.Control.Feedback>\n        </Form.Group>\n\n        <div className=\"d-grid\">\n          <Button variant=\"primary\" type=\"submit\">\n            {t('signup', { keyPrefix: 'btns' })}\n          </Button>\n        </div>\n      </Form>\n      <div className=\"text-center small mt-3\">\n        <Trans i18nKey=\"login.agreements\" ns=\"translation\">\n          By registering, you agree to the\n          <Link\n            to={privatesUrl}\n            onClick={(evt) => {\n              legalClick(evt, 'privacy');\n            }}\n            target=\"_blank\">\n            privacy policy\n          </Link>\n          and\n          <Link\n            to={policyUrl}\n            onClick={(evt) => {\n              legalClick(evt, 'tos');\n            }}\n            target=\"_blank\">\n            terms of service\n          </Link>\n          .\n        </Trans>\n      </div>\n    </>\n  );\n};\n\nexport default React.memo(Index);\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { MouseEvent, useCallback } from 'react';\n\nimport { useLegalPrivacy, useLegalTos } from '@/services/client/legal';\n\nexport const useLegalClick = () => {\n  const { data: tos } = useLegalTos();\n  const { data: privacy } = useLegalPrivacy();\n\n  const legalClick = useCallback(\n    (evt: MouseEvent, type: 'tos' | 'privacy') => {\n      evt.stopPropagation();\n      const contentText =\n        type === 'tos'\n          ? tos?.terms_of_service_original_text\n          : privacy?.privacy_policy_original_text;\n      let matchUrl: URL | undefined;\n      try {\n        if (contentText) {\n          matchUrl = new URL(contentText);\n        }\n        // eslint-disable-next-line no-empty\n      } catch (ex) {}\n      if (matchUrl) {\n        evt.preventDefault();\n        window.open(matchUrl.toString());\n      }\n    },\n    [tos, privacy],\n  );\n\n  return legalClick;\n};\n"],"names":["Index","callback","t","useTranslation","keyPrefix","formData","setFormData","useState","name","value","isInvalid","errorMsg","e_mail","pass","updateUser","userStore","state","update","emailCaptcha","useCaptchaPlugin","handleChange","params","legalClick","useLegalClick","data","tos","useLegalTos","privacy","useLegalPrivacy","useCallback","evt","type","stopPropagation","contentText","terms_of_service_original_text","privacy_policy_original_text","matchUrl","URL","ex","preventDefault","window","open","toString","handleRegister","event","reqParams","is_ab","isAssetBunPageType","captcha","getCaptcha","verify","captcha_code","captcha_id","register","then","async","close","res","catch","err","isError","handleCaptchaError","list","handleFormError","ele","document","getElementById","error_field","scrollToElementTop","isAssetBun","privatesUrl","assetBunPrivateUrl","policyUrl","assetBunPolicyUrl","_jsxs","_Fragment","children","Form","noValidate","onSubmit","checkValidated","bol","errObj","Object","keys","filter","key","check","autoComplete","Group","controlId","className","_jsx","Label","Control","required","onChange","e","target","Feedback","Button","variant","Trans","i18nKey","ns","Link","to","onClick","React"],"sourceRoot":""}