(globalThis.webpackChunkanswer_static=globalThis.webpackChunkanswer_static||[]).push([[4748,826,2486],{30826:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var n=a(28915),s=a(88844),l=a(84012),r=a(51588),i=a(81801),o=a(34202),c=(a(52486),a(68179));const d=({similarQuestions:e})=>{const{t:t}=(0,r.B)("translation",{keyPrefix:"ask"});return e&&e.length>5&&(e.length=5),(0,c.jsx)(s.A,{defaultActiveKey:"0",className:"search-question-wrap mt-3",children:(0,c.jsxs)(s.A.Item,{eventKey:"0",className:"overflow-hidden",children:[(0,c.jsx)(s.A.Button,{className:"px-3 py-2 bg-light text-body",children:t("similar_questions")}),(0,c.jsx)(s.A.Body,{className:"p-0",children:(0,c.jsx)(l.A,{variant:"flush",children:e.map((e=>(0,c.jsxs)(l.A.Item,{action:!0,as:"a",className:"link-dark text-wrap text-break",href:o.w.questionLanding(e.id,e.url_title,e.content_type),target:"_blank",children:[(0,c.jsxs)("span",{className:""+(e.accepted_answer||e.answer_count>0?"me-3":""),children:[e.title,"closed"===e.status?` [${t("closed",{keyPrefix:"question"})}] `:null]}),e.accepted_answer?(0,c.jsxs)("span",{className:"small text-success d-inline-block",children:[(0,c.jsx)(i.In,{type:"bi",name:"check-circle-fill"}),(0,c.jsx)("span",{className:"ms-1",children:t("x_answers",{keyPrefix:"question",count:e.answer_count})})]}):e.answer_count>0&&(0,c.jsxs)("span",{className:"small text-secondary d-inline-block",children:[(0,c.jsx)(i.In,{type:"bi",name:"chat-square-text-fill"}),(0,c.jsx)("span",{className:"ms-1",children:t("x_answers",{keyPrefix:"question",count:e.answer_count})})]})]},e.id)))})})]})})},u=(0,n.memo)(d)},94748:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>P});var n=a(28915),s=a(13015),l=a(98329),r=a(46261),i=a(53799),o=a(16413),c=a(18596),d=a(65200),u=a(51588),v=a(17534),h=a.n(v),m=a(14577),g=a.n(m),x=a(51955),f=a.n(x),_=a(53564),p=a.n(_),y=a(47185),j=a(81801),b=a(76812),w=a(48058),k=a(4440),A=a(34202),N=a(25831),I=a(15480),C=a(38229),M=a(24978),q=a(30826),T=a(68179);const E=new k.ZT({type:"question"}),P=()=>{const e={title:{value:"",isInvalid:!1,errorMsg:""},integral:{value:0,isInvalid:!1,errorMsg:""},tags:{value:[],isInvalid:!1,errorMsg:""},content:{value:"",isInvalid:!1,errorMsg:""},answer_content:{value:"",isInvalid:!1,errorMsg:""},edit_summary:{value:"",isInvalid:!1,errorMsg:""}},{t:t}=(0,u.B)("translation",{keyPrefix:"ask"}),[a,v]=(0,n.useState)(e),[m,x]=(0,n.useState)(e),[_,P]=(0,n.useState)(!1),[B,S]=(0,n.useState)(!1),[L,F]=(0,n.useState)(""),[$,G]=(0,n.useState)(!1),H=()=>{v(e),P(!1),F("")},[O,K]=(0,n.useState)([]),Q=(0,n.useRef)({getHtml:()=>""}),U=(0,n.useRef)({getHtml:()=>""}),{qid:R}=(0,c.g)(),V=(0,c.Zp)(),[X]=(0,d.ok)(),Y=void 0!==R,J=(0,N.T5)("question"),Z=(0,N.T5)("edit"),z=()=>{E.save.cancel(),E.remove(),G(!1)};(0,n.useEffect)((()=>{if(!R){(()=>{const e=X.get("tags");e&&(0,w.FH)(e).then((e=>{oe(e)}))})();const e=k.KP.get(b.XI);e?(a.title.value=e.title,a.content.value=e.content,a.tags.value=e.tags,a.answer_content.value=e.answer_content,P(Boolean(e.answer_content)),G(!0),v({...a})):H()}return()=>{H()}}),[R]),(0,n.useEffect)((()=>{const{title:e,tags:t,content:n,answer_content:s}=a,{title:l,tags:r,content:i}=m;R?l.value===e.value&&i.value===n.value&&f()(r.value.map((e=>e.slug_name)),t.value.map((e=>e.slug_name)))?S(!1):S(!0):e.value||t.value.length>0||n.value||s.value?(E.save({params:{title:e.value,tags:t.value,content:n.value,answer_content:s.value},callback:()=>G(!0)}),S(!0)):(z(),S(!1))}),[a]),(0,y.XB)({when:B});const D=(0,I.gH)(),{data:W=[]}=(0,w.Of)(R),{score:ee}=(0,M.bb)((e=>e.user)),te=(0,b.fQ)(),[ae,ne]=(0,n.useState)(D===b.cM.QUESTION||D===b.cM.BOUNTY?ee:1e3);let se="";D===b.cM.BOUNTY&&(se="\u8bf7\u8be6\u7ec6\u63cf\u8ff0\u4f60\u7684\u9879\u76ee\u9700\u6c42\uff0c\u9879\u76ee\u5468\u671f\u53ca\u4ea4\u4ed8\u65b9\u5f0f");const[le,re]=(0,n.useState)("");(0,n.useEffect)((()=>{Y&&(0,w.on)(R).then((e=>{re(e.accepted_answer_id),a.title.value=e.title,a.content.value=e.content,a.tags.value=e.tags.map((e=>({...e,parsed_text:"",original_text:""}))),a.integral.value=e.score,D!==b.cM.QUESTION&&D!==b.cM.BOUNTY||ne(ae+e.score),x({...a}),v({...a})}))}),[R]);const ie=(0,n.useCallback)(p()((e=>{(0,w.gr)(e).then((e=>{K(e)}))}),400),[]),oe=e=>v({...a,tags:{...a.tags,value:e,errorMsg:""}}),ce=()=>{window.confirm(t("discard_confirm",{keyPrefix:"draft"}))&&(z(),H())},de=e=>{S(!1);const t={...e,id:R,edit_summary:a.edit_summary.value},n=null===Z||void 0===Z?void 0:Z.getCaptcha();null!==n&&void 0!==n&&n.verify&&(t.captcha_code=n.captcha_code,t.captcha_id=n.captcha_id),(0,w.xL)(t).then((async e=>{await(null===Z||void 0===Z?void 0:Z.close()),V(A.w.questionLanding(R,null===e||void 0===e?void 0:e.url_title,D),{state:{isReview:null===e||void 0===e?void 0:e.wait_for_review}})})).catch((e=>{if(e.isError){null===Z||void 0===Z||Z.handleCaptchaError(e.list);const t=(0,k.NC)(e,a);v({...t});const n=document.getElementById(e.list[0].error_field);(0,k.qt)(n)}}))},ue=async e=>{var t,n,s;S(!1);const l=null===J||void 0===J?void 0:J.getCaptcha();let r;null!==l&&void 0!==l&&l.verify&&(e.captcha_code=l.captcha_code,e.captcha_id=l.captcha_id),r=_?await(0,w.eX)({...e,answer_content:a.answer_content.value}).catch((e=>{if(e.isError){if(!(null===J||void 0===J?void 0:J.handleCaptchaError(e.list))||1!==e.list.length){const t=(0,k.NC)(e,a);v({...t});const n=document.getElementById(e.list[0].error_field);(0,k.qt)(n)}}})):await(0,w.M5)(e).catch((e=>{if(e.isError){if(!(null===J||void 0===J?void 0:J.handleCaptchaError(e.list))||1!==e.list.length){const t=(0,k.NC)(e,a);v({...t});const n=document.getElementById(e.list[0].error_field);(0,k.qt)(n)}}}));const i=(null===(t=r)||void 0===t?void 0:t.id)||(null===(n=r)||void 0===n||null===(s=n.question)||void 0===s?void 0:s.id);var o,c,d;i&&(await(null===J||void 0===J?void 0:J.close()),V(_?A.w.questionLanding(i,null===(o=r)||void 0===o||null===(c=o.question)||void 0===c?void 0:c.url_title,D):A.w.questionLanding(i,null===(d=r)||void 0===d?void 0:d.url_title,D)));z()},ve=O.length>0&&!Y;let he=t("ask_a_question",{keyPrefix:"page_title"});return Y&&(he=t("edit_question",{keyPrefix:"page_title"})),(0,y.M4)({title:he}),(0,T.jsxs)("div",{className:"pt-4 mb-5",children:[(0,T.jsx)("h3",{className:"mb-4",children:t(Y?`${C.Ef[D]}`:`${C.au[D]}`)}),(0,T.jsxs)(s.A,{children:[(0,T.jsx)(l.A,{className:"page-main flex-auto",children:(0,T.jsxs)(r.A,{noValidate:!0,onSubmit:async e=>{e.preventDefault(),e.stopPropagation();const t={title:a.title.value,content:a.content.value,tags:a.tags.value,score:a.integral.value,content_type:(0,I.gH)()};if(Y){if(!Z)return void de(t);Z.check((()=>de(t)))}else{if(!J)return void ue(t);null===J||void 0===J||J.check((async()=>{ue(t)}))}},children:[Y&&(0,T.jsxs)(r.A.Group,{controlId:"revision",className:"mb-3",children:[(0,T.jsx)(r.A.Label,{children:t("form.fields.revision.label")}),(0,T.jsx)(r.A.Select,{onChange:e=>{var t;const n=e.target.value,s=W[n];a.content.value=(null===(t=s.content)||void 0===t?void 0:t.content)||"",x({...a}),v({...a})},children:W.map((({reason:e,create_at:a,user_info:n},s)=>{const l=h()(1e3*a).tz().format(t("long_date_with_time",{keyPrefix:"dates"}));return(0,T.jsx)("option",{value:s,children:`${l} - ${n.display_name} - ${e||(s===W.length-1?t("default_first_reason"):t("default_reason"))}`},`${a}`)}))})]}),(0,T.jsxs)(r.A.Group,{controlId:"title",className:"mb-3",children:[(0,T.jsx)(r.A.Label,{children:t("form.fields.title.label")}),(0,T.jsx)(r.A.Control,{type:"text",value:a.title.value,isInvalid:a.title.isInvalid,onChange:e=>{v({...a,title:{...a.title,value:e.currentTarget.value,errorMsg:""}}),e.currentTarget.value.length>=10&&ie(e.currentTarget.value),0===e.currentTarget.value.length&&K([])},placeholder:t(`form.fields.${C.au[D]}.placeholder`),autoFocus:!0,contentEditable:!0}),(0,T.jsx)(r.A.Control.Feedback,{type:"invalid",children:a.title.errorMsg}),ve&&(0,T.jsx)(q.default,{similarQuestions:O})]}),(0,T.jsxs)(r.A.Group,{controlId:"content",children:[(0,T.jsx)(r.A.Label,{children:t("form.fields.body.label")}),(0,T.jsx)(r.A.Control,{defaultValue:a.content.value,isInvalid:a.content.isInvalid,hidden:!0}),(0,T.jsx)(j.KE,{value:a.content.value,onChange:e=>{v({...a,content:{...a.content,value:e,errorMsg:""}})},className:g()("form-control p-0","content"===L&&"focus"),onFocus:()=>{F("content")},onBlur:()=>{F("")},editorPlaceholder:se,ref:Q}),(0,T.jsx)(r.A.Control.Feedback,{type:"invalid",children:a.content.errorMsg})]}),(0,T.jsxs)(r.A.Group,{controlId:"tags",className:"my-3",children:[(0,T.jsx)(r.A.Label,{children:t("form.fields.tags.label")}),(0,T.jsx)(r.A.Control,{defaultValue:JSON.stringify(a.tags.value),isInvalid:a.tags.isInvalid,hidden:!0}),(0,T.jsx)(j.Cx,{value:a.tags.value,onChange:oe,showRequiredTag:!0,maxTagLength:5}),(0,T.jsx)(r.A.Control.Feedback,{type:"invalid",children:a.tags.errorMsg})]}),(0,T.jsxs)(r.A.Group,{controlId:"integral",className:"mb-3",children:[(0,T.jsx)(r.A.Label,{children:t("form.fields.integral.label")}),(0,T.jsx)(r.A.Control,{type:"number",min:0,max:ae,step:1,value:a.integral.value,isInvalid:a.integral.isInvalid,onChange:e=>{const t=parseInt(e.currentTarget.value,10);v({...a,integral:{...a.integral,value:Math.max(0,Math.min(t,ae)),errorMsg:""}})},disabled:!!le&&"0"!==le&&te}),(0,T.jsxs)(r.A.Text,{children:[t(`${C.WN[D]}`),(0,T.jsx)("a",{href:"https://cloud.assetbun.com/buy?tab=2",target:"_blank",rel:"noopener noreferrer",children:`${t("recharge")} `}),te?t("attention"):""]}),(0,T.jsx)(r.A.Control.Feedback,{type:"invalid",children:a.integral.errorMsg})]}),Y&&(0,T.jsxs)(r.A.Group,{controlId:"edit_summary",className:"my-3",children:[(0,T.jsx)(r.A.Label,{children:t("form.fields.edit_summary.label")}),(0,T.jsx)(r.A.Control,{type:"text",defaultValue:a.edit_summary.value,isInvalid:a.edit_summary.isInvalid,placeholder:t("form.fields.edit_summary.placeholder"),onChange:e=>v({...a,edit_summary:{...a.edit_summary,value:e.currentTarget.value}}),contentEditable:!0}),(0,T.jsx)(r.A.Control.Feedback,{type:"invalid",children:a.edit_summary.errorMsg})]}),!_&&(0,T.jsxs)("div",{className:"mt-3",children:[(0,T.jsx)(i.A,{type:"submit",className:"me-2",children:t(Y?"btn_save_edits":`${C.Jh[D]}`)}),Y&&(0,T.jsx)(i.A,{variant:"link",onClick:()=>{V(-1)},children:t("cancel",{keyPrefix:"btns"})}),$&&(0,T.jsx)(i.A,{variant:"link",onClick:ce,children:t("discard_draft",{keyPrefix:"btns"})})]}),!Y&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(r.A.Check,{className:"mt-5",checked:_,type:"checkbox",label:t("answer_question"),onChange:e=>P(e.target.checked),id:"radio-answer"}),_&&(0,T.jsxs)(r.A.Group,{controlId:"answer",className:"mt-4",children:[(0,T.jsx)(r.A.Label,{children:t("form.fields.answer.label")}),(0,T.jsx)(j.KE,{value:a.answer_content.value,onChange:e=>v({...a,answer_content:{...a.answer_content,value:e,errorMsg:""}}),ref:U,className:g()("form-control p-0","answer"===L&&"focus"),onFocus:()=>{F("answer")},onBlur:()=>{F("")}}),(0,T.jsx)(r.A.Control,{type:"text",isInvalid:a.answer_content.isInvalid,hidden:!0}),(0,T.jsx)(r.A.Control.Feedback,{type:"invalid",children:a.answer_content.errorMsg})]})]}),_&&(0,T.jsxs)("div",{className:"mt-3",children:[(0,T.jsx)(i.A,{type:"submit",children:t("post_question&answer")}),$&&(0,T.jsx)(i.A,{variant:"link",className:"ms-2",onClick:ce,children:t("discard_draft",{keyPrefix:"btns"})})]})]})}),(0,T.jsx)(l.A,{className:"page-right-side mt-4 mt-xl-0",children:(0,T.jsxs)(o.A,{children:[(0,T.jsx)(o.A.Header,{children:t("title",{keyPrefix:"how_to_format"})}),(0,T.jsx)(o.A.Body,{className:"fmt small",dangerouslySetInnerHTML:{__html:t("desc",{keyPrefix:"how_to_format"})}})]})})]})]})}},51955:(e,t,a)=>{var n=a(8243);e.exports=function(e,t){return n(e,t)}},52486:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={}}}]);
//# sourceMappingURL=4748.89b097e4.chunk.js.map