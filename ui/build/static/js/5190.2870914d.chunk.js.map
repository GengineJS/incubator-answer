{"version":3,"file":"static/js/5190.2870914d.chunk.js","mappings":"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","sources":["pages/Questions/Detail/components/InviteToAnswer/PeopleDropdown.tsx","webpack://answer-static/./src/pages/Questions/Detail/components/InviteToAnswer/PeopleDropdown.scss?767d"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { FC, useEffect, useState } from 'react';\nimport { Dropdown, Form } from 'react-bootstrap';\nimport { useTranslation } from 'react-i18next';\n\nimport { loggedUserInfoStore } from '@/stores';\nimport { userSearchByName } from '@/services';\nimport { Avatar } from '@/components';\nimport * as Type from '@/common/interface';\nimport './PeopleDropdown.scss';\n\ninterface Props {\n  selectedPeople: Type.UserInfoBase[] | undefined;\n  onSelect: (people: Type.UserInfoBase) => void;\n  saveInviteUsers: () => void;\n  visible?: boolean;\n}\n\ninterface UserInfoCheck extends Type.UserInfoBase {\n  checked?: boolean;\n}\n\nconst Index: FC<Props> = ({\n  selectedPeople = [],\n  visible = false,\n  onSelect,\n  saveInviteUsers,\n}) => {\n  const { user: currentUser } = loggedUserInfoStore();\n  const { t } = useTranslation('translation', {\n    keyPrefix: 'invite_to_answer',\n  });\n  const [peopleList, setPeopleList] = useState<UserInfoCheck[]>([]);\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [searchValue, setSearchValue] = useState('');\n  const filterAndSetPeople = (source) => {\n    const filteredPeople: Type.UserInfoBase[] = [];\n    source.forEach((p) => {\n      if (\n        currentUser &&\n        currentUser.role_id === 1 &&\n        currentUser.username === p.username\n      ) {\n        return;\n      }\n      if (selectedPeople?.find((_) => _.username === p.username)) {\n        return;\n      }\n      filteredPeople.push(p);\n    });\n    setPeopleList([...selectedPeople, ...filteredPeople]);\n  };\n\n  const searchPeople = (s) => {\n    if (!s) {\n      setPeopleList([...selectedPeople]);\n      return;\n    }\n    userSearchByName(s).then((resp) => {\n      filterAndSetPeople(resp);\n    });\n  };\n  const handleSearch = (evt) => {\n    const s = evt.target.value;\n    setSearchValue(s);\n    searchPeople(s);\n  };\n\n  const resetSearch = () => {\n    setCurrentIndex(-1);\n    setSearchValue('');\n    setPeopleList([]);\n  };\n\n  const handleSelect = (idx) => {\n    if (idx < 0 || idx >= peopleList.length) {\n      return;\n    }\n    const people = peopleList[idx];\n    if (people) {\n      onSelect(people);\n    }\n  };\n\n  const handleKeyDown = (evt) => {\n    evt.stopPropagation();\n\n    if (!peopleList?.length) {\n      return;\n    }\n    const { keyCode } = evt;\n    if (keyCode === 38 && currentIndex > 0) {\n      setCurrentIndex(currentIndex - 1);\n    }\n    if (keyCode === 40 && currentIndex < peopleList.length - 1) {\n      setCurrentIndex(currentIndex + 1);\n    }\n\n    if (keyCode === 13 && currentIndex > -1) {\n      evt.preventDefault();\n      handleSelect(currentIndex);\n    }\n  };\n\n  useEffect(() => {\n    if (visible && selectedPeople.length > 0) {\n      setPeopleList(selectedPeople);\n    }\n    if (!visible) {\n      resetSearch();\n    }\n  }, [visible]);\n\n  return visible ? (\n    <Dropdown\n      autoClose=\"outside\"\n      show\n      className=\"people-dropdown\"\n      onSelect={handleSelect}\n      onKeyDown={handleKeyDown}\n      onToggle={(state) => {\n        if (!state) {\n          saveInviteUsers();\n        }\n      }}>\n      <Dropdown.Menu\n        renderOnMount\n        show\n        className=\"w-100 py-0 position-relative\">\n        <div className=\"p-3\">\n          <Form.Control\n            type=\"search\"\n            autoFocus\n            placeholder={t('search')}\n            value={searchValue}\n            onChange={handleSearch}\n          />\n        </div>\n        <div className={`${peopleList.length > 0 ? 'py-2 border-top' : ''}`}>\n          {peopleList.map((p, idx) => {\n            return (\n              <Dropdown.Item\n                key={p.username}\n                eventKey={idx}\n                onFocus={() => {\n                  setCurrentIndex(idx);\n                }}\n                active={idx === currentIndex}>\n                <Form.Check\n                  type=\"checkbox\"\n                  id={p.username}\n                  className=\"position-relative\">\n                  <Form.Check.Input\n                    type=\"checkbox\"\n                    tabIndex={-1}\n                    checked={Boolean(\n                      selectedPeople?.find((v) => v.id === p.id),\n                    )}\n                    onChange={() => {}}\n                  />\n                  <div className=\"check-cover\" />\n                  <Form.Check.Label className=\"d-flex align-items-center text-nowrap\">\n                    <Avatar\n                      avatar={p.avatar}\n                      size=\"24\"\n                      alt={p.display_name}\n                      className=\"rounded-1\"\n                    />\n                    <div className=\"d-flex flex-wrap text-truncate\">\n                      <span className=\"ms-2 text-truncate\">\n                        {p.display_name}\n                      </span>\n                      <small className=\"text-secondary text-truncate ms-2\">\n                        @{p.username}\n                      </small>\n                    </div>\n                  </Form.Check.Label>\n                </Form.Check>\n              </Dropdown.Item>\n            );\n          })}\n        </div>\n      </Dropdown.Menu>\n    </Dropdown>\n  ) : null;\n};\n\nexport default Index;\n","// extracted by mini-css-extract-plugin\nexport default {};"],"names":["Index","selectedPeople","visible","onSelect","saveInviteUsers","user","currentUser","loggedUserInfoStore","t","useTranslation","keyPrefix","peopleList","setPeopleList","useState","currentIndex","setCurrentIndex","searchValue","setSearchValue","searchPeople","s","userSearchByName","then","resp","source","filteredPeople","forEach","p","role_id","username","find","_","push","filterAndSetPeople","handleSelect","idx","length","people","useEffect","_jsx","Dropdown","autoClose","show","className","onKeyDown","evt","stopPropagation","keyCode","preventDefault","onToggle","state","children","_jsxs","Menu","renderOnMount","Form","Control","type","autoFocus","placeholder","value","onChange","target","map","Item","eventKey","onFocus","active","Check","id","Input","tabIndex","checked","Boolean","v","Label","Avatar","avatar","size","alt","display_name"],"sourceRoot":""}